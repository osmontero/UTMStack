<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <changeSet id="20250910008" author="JocLRojas">

        <sql dbms="postgresql" splitStatements="true" stripComments="true">
            <![CDATA[

            UPDATE public.utm_logstash_filter
            SET filter_version='3.0.2',
            logstash_filter='# CISCO Firepower filter, version 3.0.2
# Based on examples provided and https://www.cisco.com/c/en/us/td/docs/security/firepower/Syslogs/b_fptd_syslog_guide.html
# Filter Input requirements -> Syslog
#
# 1. Parsing the message field containing the Cisco Firepower log
pipeline:
  - dataTypes:
      - firewall-cisco-firepower
    steps:
      # Common Firepower fields
      - grok:
          patterns:
            - fieldName: log.syslogPri
              pattern: ''(\<{{.integer}}\>)''
            - fieldName: log.ciscoTime
              pattern: ''{{.day}}\s{{.monthName}}\s{{.monthDay}}\s{{.year}}\s{{.time}}''
            - fieldName: log.localIp
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.firePowerHeader
              pattern: ''{{.data}}FTD-''
            - fieldName: log.severity
              pattern: ''{{.integer}}''
            - fieldName: log.messageId
              pattern: ''-{{.integer}}''
            - fieldName: log.ciscoSeparator
              pattern: ''\:{{.space}}''
            - fieldName: log.msg
              pattern: ''{{.greedy}}''
          source: raw
      - grok:
          patterns:
            - fieldName: log.ciscoTime
              pattern: ''{{.day}}\s{{.monthName}}\s{{.monthDay}}\s{{.year}}\s{{.time}}''
            - fieldName: log.localIp
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.firePowerHeader
              pattern: ''{{.data}}FTD-''
            - fieldName: log.severity
              pattern: ''{{.integer}}''
            - fieldName: log.messageId
              pattern: ''-{{.integer}}''
            - fieldName: log.ciscoSeparator
              pattern: ''\:{{.space}}''
            - fieldName: log.msg
              pattern: ''{{.greedy}}''
          source: raw
      #......................................................................#
      # Adding log.localIp geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.localIp
            destination: log.localIp.geolocation
          where: exists("log.localIp")
      # Removing unwanted prefixes
      - trim:
          function: prefix
          substring: ''-''
          fields:
            - log.messageId
      # Field conversions
      - cast:
          fields:
            - log.messageId
          to: int
      # Begining specific message parsing
      #......................................................................#
      # FTD-2-106001
      - grok:
          patterns:
            - fieldName: log.direction
              pattern: ''{{.word}}''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: origin.port
              pattern: ''/{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: target.port
              pattern: ''/{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''flags''
            - fieldName: log.flags
              pattern: ''{{.data}}\s''
            - fieldName: log.irrelevant
              pattern: ''on\sinterface''
            - fieldName: log.srcInterface
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106001)

      - trim:
          function: prefix
          substring: ''/''
          fields:
            - origin.port
            - target.port
          where: safe("log.messageId", 0.0) == double(106001)
      #......................................................................#
      # FTD-2-106017
      - grok:
          patterns:
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''IP\sdue\sto''
            - fieldName: action
              pattern: ''{{.greedy}}from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106017)
      - trim:
          function: suffix
          substring: ''from''
          fields:
            - action
          where: safe("log.messageId", 0.0) == double(106017)
      #......................................................................#
      # FTD-1-106021
      - grok:
          patterns:
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: action
              pattern: ''{{.greedy}}from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: log.irrelevant
              pattern: ''on\sinterface''
            - fieldName: log.srcInterface
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106021)
      - trim:
          function: suffix
          substring: ''from''
          fields:
            - action
          where: safe("log.messageId", 0.0) == double(106021)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(106021)
      #......................................................................#
      # FTD-2-106101
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Number of cached deny-flows for ACL log has reached limit''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106101)
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Number of cached''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(106101)
      # Parsing the limit number
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.numFlows
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(106101)
      # Field conversions
      - cast:
          fields:
            - log.numFlows
          to: int
          where: safe("log.messageId", 0.0) == double(106101)
      #......................................................................#
      # FTD-6-106102,FTD-4-106103
      # First variant
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''access-list''
            - fieldName: log.accessList
              pattern: ''{{.data}}\s''
            - fieldName: actionResult
              pattern: ''{{.word}}''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''for user''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}})\s''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}/''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}/''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''hit-cnt''
            - fieldName: log.hitCount
              pattern: ''{{.integer}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106102) || safe("log.messageId", 0.0)==double(106103)
      # Second variant
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''access-list''
            - fieldName: log.accessList
              pattern: ''{{.data}}\s''
            - fieldName: actionResult
              pattern: ''{{.word}}''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''for user''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}})\s''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}/''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: origin.port
              pattern: ''\({{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''-\>''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}/''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: target.port
              pattern: ''\({{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''hit-cnt''
            - fieldName: log.hitCount
              pattern: ''{{.integer}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106102) || safe("log.messageId", 0.0)==106103
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(106102) || safe("log.messageId", 0.0)==106103
      - trim:
          function: prefix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(106102) || safe("log.messageId", 0.0)==106103
      - trim:
          function: suffix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(106102) || safe("log.messageId", 0.0)==106103
      - trim:
          function: prefix
          substring: ''(''
          fields:
            - origin.port
            - target.port
          where: safe("log.messageId", 0.0) == double(106102) || safe("log.messageId", 0.0)==106103
      - trim:
          function: suffix
          substring: '')''
          fields:
            - origin.port
            - target.port
          where: safe("log.messageId", 0.0) == double(106102) || safe("log.messageId", 0.0)==106103
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("actionResult", "") && (safe("log.messageId", 0.0)==106102 || safe("log.messageId", 0.0)==106103) && (safe("actionResult", "") == "Permitted" || safe("actionResult", "") == "permitted")
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("actionResult", "") && (safe("log.messageId", 0.0)==106102 || safe("log.messageId", 0.0)==106103) && (safe("actionResult", "") != "Permitted" && safe("actionResult", "") != "permitted")
      #......................................................................#
      # FTD-6-109101
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Received CoA disconnect request''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.irrelevant
              pattern: ''for user''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}}),''
            - fieldName: log.irrelevant
              pattern: ''with\saudit-session-id:''
            - fieldName: log.auditSessionId
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(109101)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Received CoA''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(109101)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(109101)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(109101)
      #......................................................................#
      # FTD-4-109102
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Received CoA {{.word}}''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.irrelevant
              pattern: '', but cannot find named session''
            - fieldName: log.auditSessionId
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(109102)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Received CoA''
            - fieldName: log.ciscoResult
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(109102)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(109102)
      #......................................................................#
      # FTD-3-109103
      - grok:
          patterns:
            - fieldName: action
              pattern: ''CoA {{.word}}''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.irrelevant
              pattern: ''failed for user''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}}),''
            - fieldName: log.irrelevant
              pattern: ''with session ID:''
            - fieldName: log.auditSessionId
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(109103)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''CoA''
            - fieldName: log.ciscoResult
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(109103)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(109103)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(109103)
      #......................................................................#
      # FTD-109201 to 109213
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''UAUTH(:)? Session(\s|=)''
            - fieldName: log.session
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''User(\s|=)''
            - fieldName: origin.user
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''Assigned IP(\s|=)''
            - fieldName: origin.ip
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.irrelevant
              pattern: '',''
            - fieldName: action
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0)>=109201 && log.messageId<=109213
      - trim:
          function: suffix
          substring: '',''
          fields:
            - log.session
            - origin.user
          where: lsafe("log.messageId", 0.0)>=109201 && log.messageId<=109213
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0)>=109201 && log.messageId<=109213
      #......................................................................#
      # FTD-6-113004
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA user {{.word}} Successful''
            - fieldName: log.irrelevant
              pattern: ''\:''
            - fieldName: log.irrelevant
              pattern: ''server(\s)?=(\s)?''
            - fieldName: target.ip
              pattern: ''{{.data}}(\:|,)''
            - fieldName: log.irrelevant
              pattern: ''(U|u)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113004)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''AAA user {{.word}}''
            - fieldName: log.ciscoResult
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(113004)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - target.ip
          where: safe("log.messageId", 0.0) == double(113004)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - target.ip
          where: safe("log.messageId", 0.0) == double(113004)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(113004)
      #......................................................................#
      # FTD-6-113005
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA user authentication Rejected(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?reason(\s)?=(\s)''
            - fieldName: log.reason
              pattern: ''{{.data}}(\:|,)''
            - fieldName: log.irrelevant
              pattern: ''(server|Server)(\s)?=(\s)?''
            - fieldName: target.ip
              pattern: ''{{.data}}(\:|,)''
            - fieldName: log.irrelevant
              pattern: ''(U|u)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.data}}(\:|,)''
            - fieldName: log.irrelevant
              pattern: ''(U|u)ser IP(\s)?=(\s)?''
            - fieldName: origin.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113005)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''AAA user authentication''
            - fieldName: log.ciscoResult
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(113005)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.reason
            - target.ip
            - origin.user
          where: safe("log.messageId", 0.0) == double(113005)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(113005)
      #......................................................................#
      # FTD-6-113008
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA transaction status ACCEPT(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?(u|U)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113008)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(113008)
      #......................................................................#
      # FTD-6-113009
      # First variant
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA retrieved default group policy''
            - fieldName: log.policy
              pattern: ''\({{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''for (u|U)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113009)
      - trim:
          function: prefix
          substring: ''(''
          fields:
            - log.policy
          where: safe("log.messageId", 0.0) == double(113009)
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.policy
          where: safe("log.messageId", 0.0) == double(113009)
      # Second variant
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA retrieved default group policy''
            - fieldName: log.policy
              pattern: ''{{.data}}\sfor''
            - fieldName: log.irrelevant
              pattern: ''(u|U)ser(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113009)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.policy
          where: safe("log.messageId", 0.0) == double(113009)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(113009)
      #......................................................................#
      # FTD-6-113010
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA challenge received for user''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}}) from server''
            - fieldName: origin.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113010)
      - trim:
          function: suffix
          substring: ''from server''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(113010)
      #......................................................................#
      # FTD-6-113011
      # First variant
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA retrieved user specific group policy''
            - fieldName: log.policy
              pattern: ''\({{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''for (u|U)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113011)
      - trim:
          function: prefix
          substring: ''(''
          fields:
            - log.policy
          where: safe("log.messageId", 0.0) == double(113011)
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.policy
          where: safe("log.messageId", 0.0) == double(113011)
      # Second variant
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA retrieved user specific group policy''
            - fieldName: log.policy
              pattern: ''{{.data}}\sfor''
            - fieldName: log.irrelevant
              pattern: ''(u|U)ser(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113011)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.policy
          where: safe("log.messageId", 0.0) == double(113011)
      #......................................................................#
      # FTD-6-113012
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA user authentication Successful(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?local database(\s)?:(\s)?user(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113012)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''AAA user authentication''
            - fieldName: log.ciscoResult
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(113012)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(113012)
      #......................................................................#
      # FTD-6-113013
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA unable to complete the request''
            - fieldName: log.irrelevant
              pattern: ''Error(\s)?:(\s)?reason(\s)?=(\s)?''
            - fieldName: log.reason
              pattern: ''{{.data}}\:''
            - fieldName: log.irrelevant
              pattern: ''user(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113013)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.reason
          where: safe("log.messageId", 0.0) == double(113013)
      #......................................................................#
      # FTD-6-113014
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA authentication server not accessible(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?server(\s)?=(\s)?''
            - fieldName: target.ip
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?(U|u)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113014)
      #......................................................................#
      # FTD-6-113015, 113017
      - grok:
          patterns:
            - fieldName: action
              pattern: ''(AAA user authentication|AAA credentials)\s(R|r)ejected(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?reason(\s)?=(\s)?''
            - fieldName: log.reason
              pattern: ''{{.data}}(\s)?\:''
            - fieldName: log.irrelevant
              pattern: ''local database(\s)?:(\s)?(U|u)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}})(\s)?:''
            - fieldName: log.irrelevant
              pattern: ''user IP(\s)?=(\s)?''
            - fieldName: target.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113015) || log.messageId==113017
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.reason
            - origin.user
          where: safe("log.messageId", 0.0) == double(113015) || log.messageId==113017
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''(AAA user authentication|AAA credentials)\s''
            - fieldName: log.ciscoResult
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(113015) || log.messageId==113017
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(113015) || log.messageId==113017
      #......................................................................#
      # FTD-6-113016
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AAA credentials rejected(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?reason(\s)?=(\s)?''
            - fieldName: log.reason
              pattern: ''{{.data}}(\s)?\:''
            - fieldName: log.irrelevant
              pattern: ''server(\s)?=(\s)?''
            - fieldName: target.ip
              pattern: ''{{.data}}(\s)?\:''
            - fieldName: log.irrelevant
              pattern: ''(U|u)ser(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}})(\s)?:''
            - fieldName: log.irrelevant
              pattern: ''user IP(\s)?=(\s)?''
            - fieldName: origin.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113016)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.reason
            - target.ip
            - origin.user
          where: safe("log.messageId", 0.0) == double(113016)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''AAA credentials''
            - fieldName: log.ciscoResult
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(113016)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(113016)
      #......................................................................#
      # FTD-4-113019
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Group(\s)?=(\s)?''
            - fieldName: origin.group
              pattern: ''{{.data}}(\s)?,''
            - fieldName: log.irrelevant
              pattern: ''(U|u)sername(\s)?=(\s)?''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}})(\s)?,''
            - fieldName: log.irrelevant
              pattern: ''IP(\s)?=(\s)?''
            - fieldName: origin.ip
              pattern: ''{{.data}},''
            - fieldName: action
              pattern: ''(\s)?Session disconnected\.''
            - fieldName: log.irrelevant
              pattern: ''(\s)?Session Type:(\s)?''
            - fieldName: log.sessionType
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''(\s)?Duration:(\s)?''
            - fieldName: log.duration
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''(\s)?Bytes xmt:(\s)?''
            - fieldName: origin.bytesSent
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''(\s)?Bytes rcv:(\s)?''
            - fieldName: origin.bytesReceived
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''(\s)?Reason:(\s)?''
            - fieldName: log.reason
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113019)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - origin.group
            - origin.user
            - origin.ip
            - log.sessionType
            - log.duration
            - origin.bytesSent
            - origin.bytesReceived
          where: safe("log.messageId", 0.0) == double(113019)
      - cast:
          fields:
            - origin.bytesSent
            - origin.bytesReceived
          to: int
          where: safe("log.messageId", 0.0) == double(113019)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(113019)
      #......................................................................#
      # FTD-113031,113032,113033
      # Common fields
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Group(\s)?''
            - fieldName: origin.group
              pattern: ''{{.data}}\sUser''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|{{.data}})(\s)?IP''
            - fieldName: origin.ip
              pattern: ''{{.ipv4}}|{{.ipv6}}|{{.hostname}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113031) || log.messageId==113032 || log.messageId==113033
      - trim:
          function: suffix
          substring: ''User''
          fields:
            - origin.group
          where: safe("log.messageId", 0.0) == double(113031) || log.messageId==113032 || log.messageId==113033
      - trim:
          function: suffix
          substring: ''IP''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(113031) || log.messageId==113032 || log.messageId==113033
      # Specific fields
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AnyConnect (vpn-filter|ipv6-vpn-filter|session not allowed)''
            - fieldName: log.filter
              pattern: ''{{.data}}\sis''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(113031) || log.messageId==113032 || log.messageId==113033
      - grok:
          patterns:
            - fieldName: action
              pattern: ''AnyConnect (vpn-filter|ipv6-vpn-filter|session not allowed)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(113031) || log.messageId==113032 || log.messageId==113033
      - trim:
          function: suffix
          substring: ''is''
          fields:
            - log.filter
          where: safe("log.messageId", 0.0) == double(113031) || log.messageId==113032 || log.messageId==113033
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(113031) || log.messageId==113032 || log.messageId==113033
      #......................................................................#
      # FTD-113034,113035,113036,113038,113039
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Group(\s)?''
            - fieldName: origin.group
              pattern: ''(\<)?{{.data}}(\>)?\sUser''
            - fieldName: origin.user
              pattern: ''(''''{{.data}}''''|(\<)?{{.data}}(\>)?)(\s)?IP''
            - fieldName: origin.ip
              pattern: ''(\<)?({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\>)?''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113034) || log.messageId==113035 || log.messageId==113036 || log.messageId==113038 || log.messageId==113039
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''User''
          fields:
            - origin.group
          where: safe("log.messageId", 0.0) == double(113034) || log.messageId==113035 || log.messageId==113036 || log.messageId==113038 || log.messageId==113039
      - trim:
          function: suffix
          substring: ''IP''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(113034) || log.messageId==113035 || log.messageId==113036 || log.messageId==113038 || log.messageId==113039
      - trim:
          function: prefix
          substring: ''<''
          fields:
            - origin.group
            - origin.user
            - origin.ip
          where: safe("log.messageId", 0.0) == double(113034) || log.messageId==113035 || log.messageId==113036 || log.messageId==113038 || log.messageId==113039
      - trim:
          function: suffix
          substring: ''>''
          fields:
            - origin.group
            - origin.user
            - origin.ip
          where: safe("log.messageId", 0.0) == double(113034) || log.messageId==113035 || log.messageId==113036 || log.messageId==113038 || log.messageId==113039
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(113039)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(113035) || log.messageId==113038
      #......................................................................#
      # FTD-4-113042
      - grok:
          patterns:
            - fieldName: action
              pattern: ''CoA: Non-HTTP connection from''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''for user''
            - fieldName: log.remoteUser
              pattern: ''(''''{{.data}}''''|{{.data}})(\s)?at''
            - fieldName: log.remoteIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(113042)
      - trim:
          function: suffix
          substring: ''from''
          fields:
            - action
          where: safe("log.messageId", 0.0) == double(113042)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(113042)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(113042)
      - trim:
          function: suffix
          substring: ''at''
          fields:
            - log.remoteUser
          where: safe("log.messageId", 0.0) == double(113042)
      #......................................................................#
      # FTD-2-201003
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Embryonic limit exceeded''
            - fieldName: log.numCons
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''/(\s)?''
            - fieldName: log.limit
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''for''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''/(\s)?''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.globalIp
              pattern: ''\({{.data}}\)''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''/(\s)?''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''on interface''
            - fieldName: log.dstInterface
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(201003)
      - trim:
          function: prefix
          substring: ''(''
          fields:
            - log.globalIp
          where: safe("log.messageId", 0.0) == double(201003)
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.globalIp
          where: safe("log.messageId", 0.0) == double(201003)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(201003)
      #......................................................................#
      # FTD-4-209003
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Fragment database limit of''
            - fieldName: log.limit
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''exceeded:(\s)?src(\s)?=(\s)?''
            - fieldName: origin.ip
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''dest(\s)?=(\s)?''
            - fieldName: target.ip
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''proto(\s)?=(\s)?''
            - fieldName: protocol
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''id(\s)?=(\s)?''
            - fieldName: log.id
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(209003)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - origin.ip
            - target.ip
            - protocol
          where: safe("log.messageId", 0.0) == double(209003)
      - cast:
          fields:
            - log.limit
          to: int
          where: safe("log.messageId", 0.0) == double(209003)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(209003)
      #......................................................................#
      # FTD-3-316001
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Denied new tunnel''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(316001)
      # Action result
      - grok:
          patterns:
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(316001)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(316001)
      #......................................................................#
      # FTD-3-316002
      - grok:
          patterns:
            - fieldName: action
              pattern: ''VPN Handle error''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?protocol=''
            - fieldName: protocol
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''src\s''
            - fieldName: log.inIfNum
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: '',(\s)?dst''
            - fieldName: log.outIfNum
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?''
            - fieldName: target.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(316002)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - protocol
          where: safe("log.messageId", 0.0) == double(316002)
      - cast:
          fields:
            - log.inIfNum
            - log.outIfNum
          to: int
          where: safe("log.messageId", 0.0) == double(316002)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(316002)
      #......................................................................#
      # FTD-6-302003,302004
      # First variant
      - grok:
          patterns:
            - fieldName: action
              pattern: ''(Built H245 connection|Pre-allocate H323 UDP backconnection)''
            - fieldName: log.irrelevant
              pattern: ''for''
            - fieldName: log.foreignAddress
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.tmpToip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})((\s)?/(\s)?{{.integer}}|(\s)?/)?''
            - fieldName: log.irrelevant
              pattern: ''(to\s)?''
            - fieldName: log.localAddress
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.tmpFromip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})((\s)?/(\s)?{{.integer}}|(\s)?/)?''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      # Second variant
      - grok:
          patterns:
            - fieldName: action
              pattern: ''(Built H245 connection|Pre-allocate H323 UDP backconnection)''
            - fieldName: log.irrelevant
              pattern: ''for''
            - fieldName: log.foreignAddress
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.tmpToip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})((\s)?/(\s)?{{.integer}}|(\s)?/)?''
            - fieldName: log.localAddress
              pattern: ''({{.ipv4}}|{{.ipv6}})''
            - fieldName: log.tmpFromip
              pattern: ''({{.ipv4}}|{{.ipv6}})((\s)?/(\s)?{{.integer}}|(\s)?/)?''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      # Parsing from/to ip and port
      - grok:
          patterns:
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: target.port
              pattern: ''{{.greedy}}''      
          source: log.tmpToip
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      - grok:
          patterns:
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''        
          source: log.tmpToip
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      - grok:
          patterns:
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: origin.port
              pattern: ''{{.greedy}}''         
          source: log.tmpFromip
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      - grok:
          patterns:
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''        
          source: log.tmpFromip
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      - trim:
          function: prefix
          substring: ''/''
          fields:
            - origin.port
            - target.port
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      # Removing temp fields
      - delete:
          fields:
            - log.tmpFromip
            - log.tmpToip
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302003) || log.messageId==302004
      #......................................................................#
      # FTD-6-302012
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Pre-allocate H225 Call Signalling Connection''
            - fieldName: log.irrelevant
              pattern: ''for faddr''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: origin.port
              pattern: ''/(\s)?{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to laddr''
            - fieldName: target.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302012)
      - trim:
          function: prefix
          substring: ''/''
          fields:
            - origin.port
          where: safe("log.messageId", 0.0) == double(302012)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302012)
      #......................................................................#
      # FTD-6-302013
      - grok:
          patterns:
            - fieldName: log.tmpDirection
              pattern: ''Built\s{{.word}}\s(Probe)?''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.connectionId
              pattern: ''({{.data}})for''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpFrom
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortFrom
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpTo
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortTo
              pattern: ''{{.integer}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302013)
      # Parsing direction field
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Built''
            - fieldName: log.direction
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpDirection
          where: safe("log.messageId", 0.0) == double(302013)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302013)
      # Parsing firewall user to, and AAA name of the user if exists
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''  
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302013)

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302013)

      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.firewallUserTo
            - origin.user
          where: safe("log.messageId", 0.0) == double(302013)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpDirection
            - log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302013)

      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302013)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
            - log.mappedIpFrom
            - log.mappedIpTo
          where: safe("log.messageId", 0.0) == double(302013)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302013)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302013)
      #......................................................................#
      # FTD-6-302014
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Teardown\s(Probe)?''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection''
            - fieldName: log.connectionId
              pattern: ''({{.data}})for''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserTo
              pattern: ''({{.data}})?duration''
            - fieldName: log.duration
              pattern: ''{{.time}}''
            - fieldName: log.irrelevant
              pattern: ''bytes''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302014)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302014)
      # Parsing firewall user to
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302014)
      # Parsing AAA user if exists
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''{{.data}}\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302014)

      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.firewallUserTo
            - origin.user
          where: safe("log.messageId", 0.0) == double(302014)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
            - log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302014)

      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302014)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(302014)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302014)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302014)
      #......................................................................#
      # FTD-6-302015
      - grok:
          patterns:
            - fieldName: log.tmpDirection
              pattern: ''Built\s{{.word}}''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection''
            - fieldName: log.connectionId
              pattern: ''({{.data}})for''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpFrom
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortFrom
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpTo
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortTo
              pattern: ''{{.integer}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302015)
      # Parsing direction field
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Built''
            - fieldName: log.direction
              pattern: ''{{.greedy}}''
          source: log.tmpDirection
          where: safe("log.messageId", 0.0) == double(302015)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302015)
      # Parsing firewall user to, and AAA name of the user if exists
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''  
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302015)

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302015)

      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.firewallUserTo
            - origin.user
          where: safe("log.messageId", 0.0) == double(302015)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpDirection
            - log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302015)

      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302015)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
            - log.mappedIpFrom
            - log.mappedIpTo
          where: safe("log.messageId", 0.0) == double(302015)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302015)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302015)
      #......................................................................#
      # FTD-6-302016
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Teardown''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection''
            - fieldName: log.connectionId
              pattern: ''({{.data}})for''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserTo
              pattern: ''({{.data}})?duration''
            - fieldName: log.duration
              pattern: ''{{.time}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302016)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302016)
      # Parsing firewall user to
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302016)
      # Parsing firewall user to, and AAA name of the user if exists
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''bytes''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''  
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302016)

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''bytes''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302016)

      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.firewallUserTo
            - origin.user
          where: safe("log.messageId", 0.0) == double(302016)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
            - log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302016)

      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302016)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(302016)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302016)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302016)
      #......................................................................#
      # FTD-6-302017
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Built''
            - fieldName: log.direction
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''GRE connection''
            - fieldName: log.connectionId
              pattern: ''({{.data}})from''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.translatedIpFrom
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.realCid
              pattern: ''{{.data}}\(''
            - fieldName: log.translatedIpTo
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302017)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302017)
      # Parsing translatedCid and, firewall user to and AAA user if present
      - grok:
          patterns:
            - fieldName: log.translatedCid
              pattern: ''{{.data}}\)''
            - fieldName: log.tmpUserInfo
              pattern: ''{{.greedy}}''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302017)
      - grok:
          patterns:
            - fieldName: log.translatedCid
              pattern: ''{{.data}}\)''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302017)
      # FW user and AAA user
      - grok:
          patterns:
            - fieldName: log.tmpFwUserTo
              pattern: ''\({{.data}}\)''
            - fieldName: target.user
              pattern: ''\({{.data}}\)''
          source: log.tmpUserInfo
          where: safe("log.messageId", 0.0) == double(302017)
      - grok:
          patterns:
            - fieldName: log.tmpFwUserTo
              pattern: ''\({{.data}}\)''
          source: log.tmpUserInfo
          where: safe("log.messageId", 0.0) == double(302017)
      # Parsing firewall user to
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302017)
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.firewallUserTo
            - target.user
            - log.translatedCid
          where: safe("log.messageId", 0.0) == double(302017)
      - trim:
          function: suffix
          substring: ''(''
          fields:
            - log.realCid
            - target.user
          where: safe("log.messageId", 0.0) == double(302017)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpDirection
            - log.tmpFwUserFrom
            - log.tmpFwUserTo
            - log.tmpUserInfo
          where: safe("log.messageId", 0.0) == double(302017)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302017)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - target.ip
            - log.translatedIpTo
          where: safe("log.messageId", 0.0) == double(302017)
      - trim:
          function: suffix
          substring: ''from''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302017)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302017)
      #......................................................................#
      # FTD-6-302018
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Teardown GRE connection''
            - fieldName: log.connectionId
              pattern: ''({{.data}})from''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.translatedIpFrom
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.realCid
              pattern: ''{{.data}}\(''
            - fieldName: log.translatedIpTo
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.translatedCid
              pattern: ''{{.data}}\)''
            - fieldName: log.tmpFwUserTo
              pattern: ''({{.data}})?duration''
            - fieldName: log.duration
              pattern: ''{{.time}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302018)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302018)
      # Parsing firewall user to
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302018)
      # Parsing firewall user to, and AAA name of the user if exists
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''bytes''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''  
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302018)

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''bytes''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''
          source: log.rest
          where: safe("log.messageId", 0.0) == double(302018)

      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.firewallUserTo
            - origin.user
            - log.translatedCid
          where: safe("log.messageId", 0.0) == double(302018)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
            - log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302018)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''(''
          fields:
            - log.realCid
          where: safe("log.messageId", 0.0) == double(302018)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302018)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - target.ip
            - log.translatedIpTo
          where: safe("log.messageId", 0.0) == double(302018)
      - trim:
          function: suffix
          substring: ''from''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302018)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302018)
      #......................................................................#
      # FTD-6-302020, 302021
      # 302020
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Built''
            - fieldName: log.direction
              pattern: ''{{.word}}''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection for faddr''
            - fieldName: log.tmpFaddrAndFwUser
              pattern: ''({{.data}})gaddr''
            - fieldName: log.tmpGaddrAndFwUser
              pattern: ''({{.data}})laddr''
            - fieldName: log.tmpLaddrAndFwUser
              pattern: ''({{.data}})type''
            - fieldName: log.icmpType
              pattern: ''({{.data}})code''
            - fieldName: log.icmpCode
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302020)
      # 302021
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Teardown''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection for faddr''
            - fieldName: log.tmpFaddrAndFwUser
              pattern: ''({{.data}})gaddr''
            - fieldName: log.tmpGaddrAndFwUser
              pattern: ''({{.data}})laddr''
            - fieldName: log.tmpLaddrAndFwUser
              pattern: ''({{.data}})type''
            - fieldName: log.icmpType
              pattern: ''({{.data}})code''
            - fieldName: log.icmpCode
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302021)
      # Common parsing for 302020 and 302021
      # For parsing faddr and fwuser from (Begin with ip/port), or icmpSeqNum
      - grok:
          patterns:
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserFrom
              pattern: ''{{.greedy}}''
          source: log.tmpFaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      - grok:
          patterns:
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.tmpFwUserFrom
              pattern: ''{{.greedy}}''
          source: log.tmpFaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # icmpSeqNum variants
      - grok:
          patterns:
            - fieldName: log.icmpSeqNum
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserFrom
              pattern: ''\({{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''gaddr''
          source: log.tmpFaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      - grok:
          patterns:
            - fieldName: log.icmpSeqNum
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserFrom
              pattern: ''gaddr''
          source: log.tmpFaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Cleaning icmpSeqNum
      - trim:
          function: suffix
          substring: ''gaddr''
          fields:
            - log.icmpSeqNum
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Continue with firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # For parsing gaddr and global fwuser (Begin with ip/port), or icmpType
      - grok:
          patterns:
            - fieldName: log.globalIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.globalPort
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserGlobal
              pattern: ''{{.greedy}}''
          source: log.tmpGaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      - grok:
          patterns:
            - fieldName: log.globalIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.tmpFwUserGlobal
              pattern: ''{{.greedy}}''
          source: log.tmpGaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # icmpType variants
      - grok:
          patterns:
            - fieldName: log.icmpType
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserGlobal
              pattern: ''\({{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''laddr''
          source: log.tmpGaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      - grok:
          patterns:
            - fieldName: log.icmpType
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserGlobal
              pattern: ''laddr''
          source: log.tmpGaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Cleaning icmpType
      - trim:
          function: suffix
          substring: ''laddr''
          fields:
            - log.icmpType
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      - trim:
          function: suffix
          substring: ''code''
          fields:
            - log.icmpType
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Continue with global firewall
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.globalFirewallUser
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserGlobal
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # For parsing laddr and fwuser to (Begin with ip/port)
      - grok:
          patterns:
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserTo
              pattern: ''{{.greedy}}''
          source: log.tmpLaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      - grok:
          patterns:
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.tmpFwUserTo
              pattern: ''{{.greedy}}''
          source: log.tmpLaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Continue with firewall user to
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserTo
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserTo
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - target.ip
            - origin.ip
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.firewallUserTo
            - log.globalFirewallUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
            - log.tmpFwUserTo
            - log.tmpFwUserGlobal
            - log.tmpFaddrAndFwUser
            - log.tmpGaddrAndFwUser
            - log.tmpLaddrAndFwUser
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302020) || log.messageId==302021
      #......................................................................#
      # FTD-6-302022, 302024, 302026
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Built''
            - fieldName: log.role
              pattern: ''({{.data}})stub''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection for''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpMappedIpPortFrom
              pattern: ''\({{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpMappedIpPortTo
              pattern: ''\({{.data}}\)''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      # Parsing mapped ip,port from tmp fields
      # With port
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpFrom
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortFrom
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\)''
          source: log.tmpMappedIpPortFrom
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      # Without port
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpFrom
              pattern: ''{{.data}}''
            - fieldName: log.irrelevant
              pattern: ''\)''
          source: log.tmpMappedIpPortFrom
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      # Parsing mapped ip,port to, from tmp fields
      # With port
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpTo
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortTo
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\)''
          source: log.tmpMappedIpPortTo
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      # Without port
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpTo
              pattern: ''{{.data}}''
            - fieldName: log.irrelevant
              pattern: ''\)''
          source: log.tmpMappedIpPortTo
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''stub''
          fields:
            - log.role
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
            - log.mappedIpFrom
            - log.mappedIpTo
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpMappedIpPortFrom
            - log.tmpMappedIpPortTo
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302022) || log.messageId==302024 || log.messageId==302026
      #......................................................................#
      # FTD-6-302023, 302025, 302027
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Teardown stub''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''connection for''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''duration''
            - fieldName: log.duration
              pattern: ''{{.time}}''
            - fieldName: log.irrelevant
              pattern: ''bytes''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''
            - fieldName: log.reason
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302023) || log.messageId==302025 || log.messageId==302027
      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302023) || log.messageId==302025 || log.messageId==302027
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(302023) || log.messageId==302025 || log.messageId==302027
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302023) || log.messageId==302025 || log.messageId==302027
      #......................................................................#
      # FTD-302033,302034
      - grok:
          patterns:
            - fieldName: action
              pattern: ''(Pre-allocated|Unable to pre-allocate) H323 GUP Connection''
            - fieldName: log.irrelevant
              pattern: ''for faddr''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.tmpPortFrom
              pattern: ''{{.data}}to laddr''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: log.tmpIpPortTo
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302033) || log.messageId==302034
      # Parsing optional ports from y to
      - grok:
          patterns:
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpPortFrom
          where: safe("log.messageId", 0.0) == double(302033) || log.messageId==302034
      - grok:
          patterns:
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.greedy}}''
          source: log.tmpIpPortTo
          where: safe("log.messageId", 0.0) == double(302033) || log.messageId==302034
      - grok:
          patterns:
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?''
          source: log.tmpIpPortTo
          where: safe("log.messageId", 0.0) == double(302033) || log.messageId==302034
      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302033) || log.messageId==302034
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(302033) || log.messageId==302034
      # Remove tmp fields
      - delete:
          fields:
            - log.tmpPortFrom
            - log.tmpIpPortTo
          where: safe("log.messageId", 0.0) == double(302033) || log.messageId==302034
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302033)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(302034)
      #......................................................................#
      # FTD-6-302303
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Built\s{{.word}}\sstate-bypass\sconnection''
            - fieldName: log.connectionId
              pattern: ''({{.data}})from''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpFrom
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortFrom
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\)''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.mappedIpTo
              pattern: ''{{.data}}/''
            - fieldName: log.mappedPortTo
              pattern: ''{{.integer}}''
            - fieldName: log.rest
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302303)
      # Protocol
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Built''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(302303)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302303)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
            - log.mappedIpFrom
            - log.mappedIpTo
          where: safe("log.messageId", 0.0) == double(302303)
      - trim:
          function: suffix
          substring: ''from''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302303)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302303)
      #......................................................................#
      # FTD-6-302304
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Teardown\s{{.word}}\sstate-bypass\sconnection''
            - fieldName: log.connectionId
              pattern: ''({{.data}})from''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.duration
              pattern: ''{{.time}}''
            - fieldName: log.irrelevant
              pattern: '',''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: '',''
            - fieldName: log.reason
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(302304)
      # Protocol
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Built''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(302304)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(302304)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(302304)
      - trim:
          function: suffix
          substring: ''from''
          fields:
            - log.connectionId
          where: safe("log.messageId", 0.0) == double(302304)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(302304)
      #......................................................................#
      # FTD-6-305009
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Built (dynamic|static) translation''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: log.tmpAclSrcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: log.mappedIpTo
              pattern: ''{{.greedy}}'' 
          source: log.msg
          where: safe("log.messageId", 0.0) == double(305009)
      # Parsing srcInterface
      # With ACL
      - grok:
          patterns:
            - fieldName: log.srcInterface
              pattern: ''{{.data}}\(''
            - fieldName: log.accessList
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpAclSrcInterface
          where: safe("log.messageId", 0.0) == double(305009)
      # Without ACL
      - grok:
          patterns:
            - fieldName: log.srcInterface
              pattern: ''{{.data}}:''
          source: log.tmpAclSrcInterface
          where: safe("log.messageId", 0.0) == double(305009)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(305009)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
            - log.tmpAclSrcInterface
      # Cleaning fields
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.accessList
          where: safe("log.messageId", 0.0) == double(305009)
      - trim:
          function: suffix
          substring: ''(''
          fields:
            - log.srcInterface
          where: safe("log.messageId", 0.0) == double(305009)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(305009)
      #......................................................................#
      # FTD-6-305010
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Teardown (dynamic|static) translation''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''duration''
            - fieldName: log.duration
              pattern: ''{{.time}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(305010)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(305010)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
      # Cleaning fields
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
          where: safe("log.messageId", 0.0) == double(305010)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(305010)
      #......................................................................#
      # FTD-6-305011
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Built\s(dynamic|static)\s(TCP|UDP|ICMP)\stranslation''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(305011)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(305011)
      # Parsing protocol
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Built\s(dynamic|static)''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(305011)
      
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
          where: safe("log.messageId", 0.0) == double(305011)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(305011)

      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(305011)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(305011)
      #......................................................................#
      # FTD-6-305012
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Teardown\s(dynamic|static)\s(TCP|UDP|ICMP)\stranslation''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: log.tmpAclSrcInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.tmpFwUserFrom
              pattern: ''({{.data}})?to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''duration''
            - fieldName: log.duration
              pattern: ''{{.time}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(305012)
      # Parsing firewall user from
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.firewallUserFrom
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpFwUserFrom
          where: safe("log.messageId", 0.0) == double(305012)
      # Parsing protocol
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Teardown\s(dynamic|static)''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(305012)
      # Parsing srcInterface
      # With ACL
      - grok:
          patterns:
            - fieldName: log.srcInterface
              pattern: ''{{.data}}\(''
            - fieldName: log.accessList
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.tmpAclSrcInterface
          where: safe("log.messageId", 0.0) == double(305012)
      # Without ACL
      - grok:
          patterns:
            - fieldName: log.srcInterface
              pattern: ''{{.data}}:''
          source: log.tmpAclSrcInterface
          where: safe("log.messageId", 0.0) == double(305012)
      # Parsing srcInterface from himself to avoid parsing issues
      - grok:
          patterns:
            - fieldName: log.srcInterface
              pattern: ''{{.data}}\(''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.srcInterface
          where: safe("log.messageId", 0.0) == double(305012)
      
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.firewallUserFrom
            - log.accessList
          where: safe("log.messageId", 0.0) == double(305012)
      # Removing tmp fields
      - delete:
          fields:
            - log.tmpFwUserFrom
            - log.tmpAclSrcInterface
          where: safe("log.messageId", 0.0) == double(305012)

      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.srcInterface
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(305012)
      - trim:
          function: suffix
          substring: ''(''
          fields:
            - log.srcInterface
          where: safe("log.messageId", 0.0) == double(305012)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(305012)
      #......................................................................#
      # FTD-3-322001
      - grok:
          patterns:
            - fieldName: action
              pattern: ''{{.word}}\sMAC\saddress''
            - fieldName: log.localMac
              pattern: ''{{.data}}(\s)?,''
            - fieldName: log.reason
              pattern: ''{{.data}}on''
            - fieldName: log.irrelevant
              pattern: ''interface''
            - fieldName: log.srcInterface
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(322001)
      # Action result
      - grok:
          patterns:
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(322001)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '',''
          fields:
            - log.localMac
          where: safe("log.messageId", 0.0) == double(322001)
      - trim:
          function: suffix
          substring: ''on''
          fields:
            - log.reason
          where: safe("log.messageId", 0.0) == double(322001)
      #......................................................................#
      # FTD-3-322002
      - grok:
          patterns:
            - fieldName: action
              pattern: ''{{.word}}\sinspection\scheck''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''for\sarp''
            - fieldName: log.httpMessageType
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''received\sfrom\shost''
            - fieldName: origin.mac
              pattern: ''{{.data}}on''
            - fieldName: log.irrelevant
              pattern: ''interface''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}\.''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}Address''
            - fieldName: log.fakeSrcMac
              pattern: ''{{.data}}for''
            - fieldName: log.irrelevant
              pattern: ''IP\sAddress''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}Address''
            - fieldName: log.boudSrcMac
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(322002)
      # Protocol
      - grok:
          patterns:
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''inspection check''
          source: action
          where: safe("log.messageId", 0.0) == double(322002)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''on''
          fields:
            - origin.mac
          where: safe("log.messageId", 0.0) == double(322002)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.fakeSrcMac
          where: safe("log.messageId", 0.0) == double(322002)
      - trim:
          function: suffix
          substring: ''.''
          fields:
            - log.srcInterface
          where: safe("log.messageId", 0.0) == double(322002)
      #......................................................................#
      # FTD-3-322003
      - grok:
          patterns:
            - fieldName: action
              pattern: ''{{.word}}\sinspection\scheck''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''for\sarp''
            - fieldName: log.httpMessageType
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''received\sfrom\shost''
            - fieldName: origin.mac
              pattern: ''{{.data}}on''
            - fieldName: log.irrelevant
              pattern: ''interface''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}\.''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}Address''
            - fieldName: log.fakeSrcMac
              pattern: ''{{.data}}for''
            - fieldName: log.irrelevant
              pattern: ''IP\sAddress''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(322003)
      # Protocol
      - grok:
          patterns:
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''inspection check''
          source: action
          where: safe("log.messageId", 0.0) == double(322003)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''on''
          fields:
            - origin.mac
          where: safe("log.messageId", 0.0) == double(322003)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.fakeSrcMac
          where: safe("log.messageId", 0.0) == double(322003)
      - trim:
          function: suffix
          substring: ''.''
          fields:
            - log.srcInterface
          where: safe("log.messageId", 0.0) == double(322003)
      #......................................................................#
      # FTD-4-402114
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''IPSEC\:(\s)?''
            - fieldName: action
              pattern: ''Received\s(an|a)\s{{.word}}\spacket''
            - fieldName: log.irrelevant
              pattern: ''\({{.data}}=''
            - fieldName: log.spi
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}=''
            - fieldName: log.seqNum
              pattern: ''{{.integer}}(\s)?\)''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(402114)
      # Protocol
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Received\s(an|a)''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(402114)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '',''
          fields:
            - log.spi
          where: safe("log.messageId", 0.0) == double(402114)
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.seqNum
          where: safe("log.messageId", 0.0) == double(402114)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(402114)
      #......................................................................#
      # FTD-4-402115
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''IPSEC\:(\s)?''
            - fieldName: action
              pattern: ''Received\sa\spacket''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''containing''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''data instead of''
            - fieldName: log.expectedProtocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(402115)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(402115)
      #......................................................................#
      # FTD-4-402116
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''IPSEC\:(\s)?''
            - fieldName: action
              pattern: ''Received\s(an|a)\s{{.word}}\spacket''
            - fieldName: log.irrelevant
              pattern: ''\({{.data}}=''
            - fieldName: log.spi
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}=''
            - fieldName: log.seqNum
              pattern: ''{{.integer}}(\s)?\)''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}as''
            - fieldName: log.decapsulatedPktDestAddr
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}as''
            - fieldName: log.decapsulatedPktSrcAddr
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}as''
            - fieldName: log.decapsulatedPktProto
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}as''
            - fieldName: log.localProxyIpAddr
              pattern: ''{{.data}}/''
            - fieldName: log.localProxyIpMask
              pattern: ''{{.data}}/''
            - fieldName: log.localProxyProto
              pattern: ''{{.data}}/''
            - fieldName: log.localProxyPort
              pattern: ''{{.data}}and''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}as''
            - fieldName: log.remoteProxyIpAddr
              pattern: ''{{.data}}/''
            - fieldName: log.remoteProxyIpMask
              pattern: ''{{.data}}/''
            - fieldName: log.remoteProxyProto
              pattern: ''{{.data}}/''
            - fieldName: log.remoteProxyPort
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(402116)
      # Protocol
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Received\s(an|a)''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(402116)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '',''
          fields:
            - log.spi
          where: safe("log.messageId", 0.0) == double(402116)
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.seqNum
            - origin.user
          where: safe("log.messageId", 0.0) == double(402116)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - log.localProxyIpAddr
            - log.localProxyIpMask
            - log.localProxyProto
            - log.remoteProxyIpAddr
            - log.remoteProxyIpMask
            - log.remoteProxyPort
            - log.remoteProxyProto
          where: safe("log.messageId", 0.0) == double(402116)
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.seqNum
            - origin.user
          where: safe("log.messageId", 0.0) == double(402116)
      - trim:
          function: suffix
          substring: ''and''
          fields:
            - log.localProxyPort
          where: safe("log.messageId", 0.0) == double(402116)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(402116)
      #......................................................................#
      # FTD-4-402117
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''IPSEC\:(\s)?''
            - fieldName: action
              pattern: ''Received a non-IPsec \((\s)?{{.word}}(\s)?\) packet''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(402117)
      # Protocol
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Received a non-IPsec \(''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(402117)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(402117)
      #......................................................................#
      # FTD-4-402118
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''IPSEC\:(\s)?''
            - fieldName: action
              pattern: ''Received\s(an|a)\s{{.word}}\spacket''
            - fieldName: log.irrelevant
              pattern: ''\({{.data}}=''
            - fieldName: log.spi
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}=''
            - fieldName: log.seqNum
              pattern: ''{{.integer}}(\s)?\)''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}length''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''with offset''
            - fieldName: log.fragmentOffset
              pattern: ''{{.integer}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(402118)
      # Protocol
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Received\s(an|a)''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(402118)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.seqNum
            - origin.user
          where: safe("log.messageId", 0.0) == double(402118)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - log.spi
          where: safe("log.messageId", 0.0) == double(402118)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(402118)
      #......................................................................#
      # FTD-4-402119, 402120
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''IPSEC\:(\s)?''
            - fieldName: action
              pattern: ''Received\s(an|a)\s{{.word}}\spacket''
            - fieldName: log.irrelevant
              pattern: ''\({{.data}}=''
            - fieldName: log.spi
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}=''
            - fieldName: log.seqNum
              pattern: ''{{.integer}}(\s)?\)''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: origin.user
              pattern: ''{{.data}}\)''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(402119) || log.messageId==402120
      # Protocol
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Received\s(an|a)''
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(402119) || log.messageId==402120
      # Cleaning fields
      - trim:
          function: suffix
          substring: '')''
          fields:
            - log.seqNum
            - origin.user
          where: safe("log.messageId", 0.0) == double(402119) || log.messageId==402120
      - trim:
          function: suffix
          substring: '',''
          fields:
            - log.spi
          where: safe("log.messageId", 0.0) == double(402119) || log.messageId==402120
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(402119) || log.messageId==402120
      #......................................................................#
      # FTD-5-402128
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''CRYPTO\:(\s)?''
            - fieldName: action
              pattern: ''An attempt to allocate a large memory block''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}\:''
            - fieldName: log.memorySize
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}\:''
            - fieldName: log.memoryLimit
              pattern: ''{{.integer}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(402128)
      #......................................................................#
      # FTD-4-405001
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Received ARP (request|response) collision''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.mac
              pattern: ''{{.data}}on''
            - fieldName: log.irrelevant
              pattern: ''interface''
            - fieldName: log.srcInterface
              pattern: ''{{.data}}with''
            - fieldName: log.irrelevant
              pattern: ''existing ARP entry''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.mac
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(405001)
      # Adding protocol
      - add:
          function: ''string''
          params:
            key: protocol
            value: ''ARP''
          where: safe("log.messageId", 0.0) == double(405001)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(405001)
      - trim:
          function: suffix
          substring: ''on''
          fields:
            - origin.mac
          where: safe("log.messageId", 0.0) == double(405001)
      - trim:
          function: suffix
          substring: ''with''
          fields:
            - log.srcInterface
          where: safe("log.messageId", 0.0) == double(405001)
      #......................................................................#
      # FTD-4-405002
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Received mac mismatch collision''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.mac
              pattern: ''{{.data}}for''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(405002)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - origin.mac
          where: safe("log.messageId", 0.0) == double(405002)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
          where: safe("log.messageId", 0.0) == double(405002)
      #......................................................................#
      # FTD-4-406001
      - grok:
          patterns:
            - fieldName: action
              pattern: ''FTP port command low port(\s)?\:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?''
            - fieldName: log.irrelevant
              pattern: ''on interface''
            - fieldName: log.srcInterface
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(406001)
      # Adding protocol
      - add:
          function: ''string''
          params:
            key: protocol
            value: ''FTP''
          where: safe("log.messageId", 0.0) == double(406001)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - action
          where: safe("log.messageId", 0.0) == double(406001)
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
          where: safe("log.messageId", 0.0) == double(406001)
      #......................................................................#
      # FTD-4-406002
      - grok:
          patterns:
            - fieldName: action
              pattern: ''FTP port command different address(\s)?\:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: log.connectionIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?''
            - fieldName: log.irrelevant
              pattern: ''(\s)?\)''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''on interface''
            - fieldName: log.srcInterface
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(406002)
      # Adding protocol
      - add:
          function: ''string''
          params:
            key: protocol
            value: ''FTP''
          where: safe("log.messageId", 0.0) == double(406002)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '':''
          fields:
            - action
          where: safe("log.messageId", 0.0) == double(406002)
      #......................................................................#
      # FTD-4-407002
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Embryonic limit {{.data}} for through connections exceeded''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}\.''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.globalIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?''
            - fieldName: log.irrelevant
              pattern: ''\(''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''(\s)?\)(\s)?/''
            - fieldName: target.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''on interface''
            - fieldName: log.srcInterface
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(407002)
      # Connection number and connection limit
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Embryonic limit''
            - fieldName: log.numCons
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''/''
            - fieldName: log.limit
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(407002)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(407002)
      #......................................................................#
      # FTD-6-605004
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Login\s{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}\:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.service
              pattern: ''{{.data}}for''
            - fieldName: log.irrelevant
              pattern: ''user''
            - fieldName: origin.user
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(605004)
      # Action result
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Login''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
          source: action
          where: safe("log.messageId", 0.0) == double(605004)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(605004)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(605004)
      - trim:
          function: suffix
          substring: ''for''
          fields:
            - log.service
          where: safe("log.messageId", 0.0) == double(605004)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(605004)
      - trim:
          function: prefix
          substring: ''"''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(605004)
      - trim:
          function: suffix
          substring: ''"''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(605004)
      #......................................................................#
      # FTD-2-106018
      - grok:
          patterns:
            - fieldName: action
              pattern: ''ICMP packet''
            - fieldName: log.irrelevant
              pattern: ''type''
            - fieldName: log.icmpType
              pattern: ''{{.data}}\s''
            - fieldName: log.ciscoResult
              pattern: ''denied''
            - fieldName: log.irrelevant
              pattern: ''by''
            - fieldName: log.direction
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''list''
            - fieldName: log.accessList
              pattern: ''{{.data}}src''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''dest''
            - fieldName: target.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106018)
      # Adding protocol
      - add:
          function: ''string''
          params:
            key: protocol
            value: ''ICMP''
          where: safe("log.messageId", 0.0) == double(106018)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''src''
          fields:
            - log.accessList
          where: safe("log.messageId", 0.0) == double(106018)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(106018)
      #......................................................................#
      # FTD-2-106020
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Deny IP teardrop fragment''
            - fieldName: log.irrelevant
              pattern: ''\((\s)?size(\s)?=''
            - fieldName: origin.bytesSent
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: '',(\s)?offset(\s)?=''
            - fieldName: log.fragmentOffset
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''\)(\s)?from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: target.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(106020)
      # Adding log.ciscoResult
      - add:
          function: ''string''
          params:
            key: log.ciscoResult
            value: ''Denied''
          where: safe("log.messageId", 0.0) == double(106020)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(106020)
      #......................................................................#
      # FTD-6-611301
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:''
            - fieldName: action
              pattern: ''NAT configured for Client Mode with no split tunneling''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}ress\:''
            - fieldName: log.mappedIp
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611301)
      # Adding protocol
      - add:
          function: ''string''
          params:
            key: protocol
            value: ''NAT''
          where: safe("log.messageId", 0.0) == double(611301)
      #......................................................................#
      # FTD-6-611303
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:''
            - fieldName: action
              pattern: ''NAT configured for Client Mode with split tunneling''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}ress\:''
            - fieldName: log.mappedIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}works\:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.netmaskFrom
              pattern: ''{{.data}}\s''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.netmaskTo
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611303)
      # Adding protocol
      - add:
          function: ''string''
          params:
            key: protocol
            value: ''NAT''
          where: safe("log.messageId", 0.0) == double(611303)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(611303)
      #......................................................................#
      # FTD-6-611304
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:''
            - fieldName: action
              pattern: ''NAT exemption configured for Network Extension Mode with split tunneling''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}works\:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.netmaskFrom
              pattern: ''{{.data}}\s''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: log.netmaskTo
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611304)
      # Adding protocol
      - add:
          function: ''string''
          params:
            key: protocol
            value: ''NAT''
          where: safe("log.messageId", 0.0) == double(611304)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(611304)
      #......................................................................#
      # FTD-6-611307
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:(\s)?Head end\:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611307)
      # Adding action and log.ciscoResult
      - add:
          function: ''string''
          params:
            key: action
            value: ''The VPN client is connected to the specified headend''
          where: safe("log.messageId", 0.0) == double(611307)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(611307)
      #......................................................................#
      # FTD-6-611309
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:''
            - fieldName: action
              pattern: ''Disconnecting from head end and uninstalling previously downloaded policy''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}End\:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611309)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(611309)
      #......................................................................#
      # FTD-6-611310,611311
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:''
            - fieldName: action
              pattern: ''XAUTH''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''\:(\s)?Peer(\s)?\:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611310) || log.messageId==611311
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(611310)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(611311)
      #......................................................................#
      # FTD-6-611314
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:(\s)?Load Balancing Cluster with Virtual IP\:(\s)?''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}server''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611314)
      # Adding action
      - add:
          function: ''string''
          params:
            key: action
            value: ''Load Balancing Cluster redirected the Secure Firewall''
          where: safe("log.messageId", 0.0) == double(611314)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(611314)
      #......................................................................#
      # FTD-6-611315
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:(\s)?Disconnecting from Load Balancing Cluster member(\:)?(\s)?''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611315)
      # Adding action
      - add:
          function: ''string''
          params:
            key: action
            value: ''Disconnecting from Load Balancing Cluster''
          where: safe("log.messageId", 0.0) == double(611315)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(611315)
      #......................................................................#
      # FTD-6-611318
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient\:''
            - fieldName: action
              pattern: ''User Authentication Enabled''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}IP(\s)?\:''
            - fieldName: log.authServerIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}Port(\s)?\:''
            - fieldName: log.authServerPort
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}out(\s)?\:''
            - fieldName: log.timeOut
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611318)
      #......................................................................#
      # FTD-3-710003
      - grok:
          patterns:
            - fieldName: action
              pattern: ''(TCP|UDP) access denied by ACL''
            - fieldName: log.irrelevant
              pattern: ''from''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: origin.port
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''to''
            - fieldName: log.dstInterface
              pattern: ''{{.data}}(\s)?:''
            - fieldName: target.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\s)?/''
            - fieldName: target.port
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(710003)
      # Protocol and log.ciscoResult
      - grok:
          patterns:
            - fieldName: protocol
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.word}}''
            - fieldName: log.ciscoResult
              pattern: ''{{.word}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(710003)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - origin.ip
            - target.ip
          where: safe("log.messageId", 0.0) == double(710003)
      - trim:
          function: suffix
          substring: '':''
          fields:
            - log.dstInterface
          where: safe("log.messageId", 0.0) == double(710003)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(710003)
      #......................................................................#
      # FTD-5-713252,713253
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Group(\s)?=''
            - fieldName: origin.group
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''Username(\s)?=''
            - fieldName: origin.user
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''IP(\s)?=''
            - fieldName: origin.ip
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}available(\.)?''
            - fieldName: action
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(713252) || safe("log.messageId", 0.0)==double(713253)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '',''
          fields:
            - origin.group
            - origin.user
            - origin.ip
          where: safe("log.messageId", 0.0) == double(713252) || safe("log.messageId", 0.0)==double(713253)
      - trim:
          function: prefix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(713252) || safe("log.messageId", 0.0)==double(713253)
      - trim:
          function: suffix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(713252) || safe("log.messageId", 0.0)==double(713253)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(713252)
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(713253)
      #......................................................................#
      # FTD-6-716001,716002,716003
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Group(\s)?''
            - fieldName: origin.group
              pattern: ''{{.data}}User''
            - fieldName: origin.user
              pattern: ''{{.data}}IP''
            - fieldName: origin.ip
              pattern: ''(\<)?({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\>)?''
            - fieldName: action
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002 || log.messageId==716003
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''User''
          fields:
            - origin.group
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002 || log.messageId==716003
      - trim:
          function: suffix
          substring: ''IP''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002 || log.messageId==716003
      - trim:
          function: prefix
          substring: ''<''
          fields:
            - origin.group
            - origin.user
            - origin.ip
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002 || log.messageId==716003
      - trim:
          function: suffix
          substring: ''>''
          fields:
            - origin.group
            - origin.user
            - origin.ip
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002 || log.messageId==716003
      - trim:
          function: prefix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002 || log.messageId==716003
      - trim:
          function: suffix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002 || log.messageId==716003
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(716001) || log.messageId==716002
      #......................................................................#
      # FTD-6-716004,716005,716006,716007,716009
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Group(\s)?''
            - fieldName: origin.group
              pattern: ''{{.data}}User''
            - fieldName: origin.user
              pattern: ''{{.data}}\s''
            - fieldName: action
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(716004) || log.messageId==716005 || log.messageId==716006 || log.messageId==716007 || log.messageId==716009
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''User''
          fields:
            - origin.group
          where: safe("log.messageId", 0.0) == double(716004) || log.messageId==716005 || log.messageId==716006 || log.messageId==716007 || log.messageId==716009
      - trim:
          function: prefix
          substring: ''<''
          fields:
            - origin.group
            - origin.user
          where: safe("log.messageId", 0.0) == double(716004) || log.messageId==716005 || log.messageId==716006 || log.messageId==716007 || log.messageId==716009
      - trim:
          function: suffix
          substring: ''>''
          fields:
            - origin.group
            - origin.user
          where: safe("log.messageId", 0.0) == double(716004) || log.messageId==716005 || log.messageId==716006 || log.messageId==716007 || log.messageId==716009
      - trim:
          function: prefix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716004) || log.messageId==716005 || log.messageId==716006 || log.messageId==716007 || log.messageId==716009
      - trim:
          function: suffix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716004) || log.messageId==716005 || log.messageId==716006 || log.messageId==716007 || log.messageId==716009
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(716004) || log.messageId==716007 || log.messageId==716009
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(716006)
      #......................................................................#
      # FTD-6-716038
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Group(\s)?''
            - fieldName: origin.group
              pattern: ''{{.data}}User''
            - fieldName: origin.user
              pattern: ''{{.data}}IP''
            - fieldName: origin.ip
              pattern: ''(\<)?({{.ipv4}}|{{.ipv6}}|{{.hostname}})(\>)?''
            - fieldName: action
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(716038)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(716038)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''User''
          fields:
            - origin.group
          where: safe("log.messageId", 0.0) == double(716038)
      - trim:
          function: suffix
          substring: ''IP''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716038)
      - trim:
          function: prefix
          substring: ''<''
          fields:
            - origin.group
            - origin.user
            - origin.ip
          where: safe("log.messageId", 0.0) == double(716038)
      - trim:
          function: suffix
          substring: ''>''
          fields:
            - origin.group
            - origin.user
            - origin.ip
          where: safe("log.messageId", 0.0) == double(716038)
      - trim:
          function: prefix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716038)
      - trim:
          function: suffix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(716038)
      - trim:
          function: suffix
          substring: '',''
          fields:
            - action
          where: safe("log.messageId", 0.0) == double(716038)
      #......................................................................#
      # FTD-6-716039
      - grok:
          patterns:
            - fieldName: action
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''group(\s)?=''
            - fieldName: origin.group
              pattern: ''{{.data}}user''
            - fieldName: log.irrelevant
              pattern: ''=''
            - fieldName: origin.user
              pattern: ''{{.data}},''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(716039)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(716039)
      # Cleaning fields
      - trim:
          function: suffix
          substring: '',''
          fields:
            - action
            - origin.user
          where: safe("log.messageId", 0.0) == double(716039)
      - trim:
          function: suffix
          substring: ''user''
          fields:
            - origin.group
          where: safe("log.messageId", 0.0) == double(716039)
      #......................................................................#
      # FTD-6-719017,719019,719020,719021,719022,719023
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''WebVPN user(\:)?''
            - fieldName: origin.user
              pattern: ''{{.data}}\s''
            - fieldName: action
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(719017) || (log.messageId>=719019 && log.messageId<=719023)
      # Adding log.ciscoResult and modifying some actions
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(719019) || log.messageId==719023
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(719020) || log.messageId==719022
      - add:
          function: ''string''
          params:
            key: action
            value: ''WebVPN user is not checked against ACL''
          where: safe("log.messageId", 0.0) == double(719021)
      - add:
          function: ''string''
          params:
            key: action
            value: ''WebVPN user has been authenticated''
          where: safe("log.messageId", 0.0) == double(719022)
      - add:
          function: ''string''
          params:
            key: action
            value: ''WebVPN user has not been authenticated''
          where: safe("log.messageId", 0.0) == double(719023)
      # Cleaning fields
      - trim:
          function: prefix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(719017) || (log.messageId>=719019 && log.messageId<=719023)
      - trim:
          function: suffix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(719017) || (log.messageId>=719019 && log.messageId<=719023)
      #......................................................................#
      # FTD-6-719018
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''WebVPN user(\:)?''
            - fieldName: origin.user
              pattern: ''{{.data}}\s''
            - fieldName: log.irrelevant
              pattern: ''ACL ID''
            - fieldName: log.accessList
              pattern: ''{{.data}}not''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(719018)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''''''''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(719018)
      - trim:
          function: suffix
          substring: ''not''
          fields:
            - log.accessList
          where: safe("log.messageId", 0.0) == double(719018)
      #......................................................................#
      # FTD-6-719024
      - grok:
          patterns:
            - fieldName: action
              pattern: ''Email Proxy piggyback auth fail''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}=''
            - fieldName: log.sessionPointer
              pattern: ''{{.data}}user''
            - fieldName: log.irrelevant
              pattern: ''=''
            - fieldName: origin.user
              pattern: ''{{.data}}addr''
            - fieldName: log.irrelevant
              pattern: ''=''
            - fieldName: origin.ip
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(719024)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''user''
          fields:
            - log.sessionPointer
          where: safe("log.messageId", 0.0) == double(719024)
      - trim:
          function: suffix
          substring: ''addr''
          fields:
            - origin.user
          where: safe("log.messageId", 0.0) == double(719024)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where: safe("log.messageId", 0.0) == double(719024)
      #......................................................................#
      # FTD-7-609002
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''Teardown local-host''
            - fieldName: log.zoneName
              pattern: ''{{.data}}/''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}\:''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''duration''
            - fieldName: log.duration
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(609002)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''/''
          fields:
            - log.zoneName
          where: safe("log.messageId", 0.0) == double(609002)
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(609002)
      #......................................................................#
      # FTD-6-611305
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''VPNClient(\s)?\:''
            - fieldName: action
              pattern: ''DHCP Policy installed''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}DNS(\s)?\:''
            - fieldName: log.primaryDns
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}DNS(\s)?\:''
            - fieldName: log.secondaryDns
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}WINS(\s)?\:''
            - fieldName: log.primaryWins
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}WINS(\s)?\:''
            - fieldName: log.secondaryWins
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(611305)
      #......................................................................#
      # FTD-4-733100
      - grok:
          patterns:
            - fieldName: action
              pattern: ''{{.data}}exceeded''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.burstRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.maxBurstRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.avgRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.maxAvgRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.cumulativeTotalCount
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(733100)
      # Cleaning cumulative total count
      - grok:
          patterns:
            - fieldName: log.cumulativeTotalCount
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.cumulativeTotalCount
          where: safe("log.messageId", 0.0) == double(733100)
      # Parsing drop source object
      - grok:
          patterns:
            - fieldName: log.dropSourceObject
              pattern: ''{{.data}}drop''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(733100)
      # Cleaning fields
      - trim:
          function: suffix
          substring: ''drop''
          fields:
            - log.dropSourceObject
          where: safe("log.messageId", 0.0) == double(733100)
      - trim:
          function: suffix
          substring: '']''
          fields:
            - log.dropSourceObject
          where: safe("log.messageId", 0.0) == double(733100)
      - trim:
          function: prefix
          substring: ''[''
          fields:
            - log.dropSourceObject
          where: safe("log.messageId", 0.0) == double(733100)
      #......................................................................#
      # FTD-4-733101
      - grok:
          patterns:
            - fieldName: action
              pattern: ''{{.data}}(targeted|attacking)''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.burstRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.maxBurstRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.avgRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.maxAvgRateValue
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.data}}is''
            - fieldName: log.cumulativeTotalCount
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(733101)
      # Cleaning cumulative total count
      - grok:
          patterns:
            - fieldName: log.cumulativeTotalCount
              pattern: ''{{.integer}}''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.cumulativeTotalCount
          where: safe("log.messageId", 0.0) == double(733101)
      # Parsing drop source object
      - grok:
          patterns:
            - fieldName: log.dropSourceObject
              pattern: ''{{.word}}''
            - fieldName: log.tmpIp
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: action
          where: safe("log.messageId", 0.0) == double(733101)
      # Renaming from or to ip, according to -> if (targeted|attacking)
      - rename:
          from:
            - log.tmpIp
          to: origin.ip
          where: safe("log.messageId", 0.0) == double(733101) && action.contains("attacking")
      - rename:
          from:
            - log.tmpIp
          to: target.ip
          where: safe("log.messageId", 0.0) == double(733101) && action.contains("targeted")
      # Adding action result
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where: safe("log.messageId", 0.0) == double(733101)
      #......................................................................#
      # FTD-4-733102, 733103
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: ''{{.data}}host''
            - fieldName: origin.ip
              pattern: ''({{.ipv4}}|{{.ipv6}}|{{.hostname}})''
            - fieldName: log.irrelevant
              pattern: ''{{.greedy}}''
          source: log.msg
          where: safe("log.messageId", 0.0) == double(733102) || log.messageId==733103
      # Adding action
      - add:
          function: ''string''
          params:
            key: action
            value: ''Threat-detection add host to shun list''
          where: (safe("log.messageId", 0.0)==733102 || log.messageId==733103) && log.msg.contains("add")
      - add:
          function: ''string''
          params:
            key: action
            value: ''Threat-detection removes host to shun list''
          where: (safe("log.messageId", 0.0)==733102 || log.messageId==733103) && log.msg.contains("removes")
      #......................................................................#
      # Decoding severity
      - add:
          function: ''string''
          params:
            key: severity
            value: ''high''
          where: log.severity=="1" || log.severity=="2" || log.severity=="3"
      - add:
          function: ''string''
          params:
            key: severity
            value: ''medium''
          where: log.severity=="4"
      - add:
          function: ''string''
          params:
            key: severity
            value: ''low''
          where: log.severity=="5" || log.severity=="6" || log.severity=="7"
      #......................................................................#
      # Adding common geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: origin.ip
            destination: origin.geolocation
          where: exists("origin.ip")
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: target.ip
            destination: target.geolocation
          where: exists("target.ip")
      # Adding log.mappedIpFrom geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.mappedIpFrom
            destination: log.mappedIpFrom.geolocation
          where: exists("log.mappedIpFrom")
      # Adding log.mappedIpTo geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.mappedIpTo
            destination: log.mappedIpTo.geolocation
          where: exists("log.mappedIpTo")
      # Adding log.translatedIpFrom geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.translatedIpFrom
            destination: log.translatedIpFrom.geolocation
          where: exists("log.translatedIpFrom")
      # Adding log.translatedIpTo geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.translatedIpTo
            destination: log.translatedIpTo.geolocation
          where: exists("log.translatedIpTo")
      # Adding log.globalIp geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.globalIp
            destination: log.globalIp.geolocation
          where: exists("log.globalIp")
      # Adding log.remoteIp geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.remoteIp
            destination: log.remoteIp.geolocation
          where: exists("log.remoteIp")
      # Adding log.mappedIp geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.mappedIp
            destination: log.mappedIp.geolocation
          where: exists("log.mappedIp")
      # Adding log.decapsulatedPktDestAddr geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.decapsulatedPktDestAddr
            destination: log.decapsulatedPktDestAddr.geolocation
          where: exists("log.decapsulatedPktDestAddr")
      # Adding log.decapsulatedPktSrcAddr geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.decapsulatedPktSrcAddr
            destination: log.decapsulatedPktSrcAddr.geolocation
          where: exists("log.decapsulatedPktSrcAddr")
      # Adding log.localProxyIpAddr geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.localProxyIpAddr
            destination: log.localProxyIpAddr.geolocation
          where: exists("log.localProxyIpAddr")
      # Adding log.remoteProxyIpAddr geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.remoteProxyIpAddr
            destination: log.remoteProxyIpAddr.geolocation
          where: exists("log.remoteProxyIpAddr")
      # Adding log.primaryDns geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.primaryDns
            destination: log.primaryDns.geolocation
          where: exists("log.primaryDns")
      # Adding log.secondaryDns geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.secondaryDns
            destination: log.secondaryDns.geolocation
          where: exists("log.secondaryDns")
      # Adding log.primaryWins geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.primaryWins
            destination: log.primaryWins.geolocation
          where: exists("log.primaryWins")
      # Adding log.secondaryWins geolocation
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: log.secondaryWins
            destination: log.secondaryWins.geolocation
          where: exists("log.secondaryWins")
      #......................................................................#
      # Common field conversions
      - cast:
          fields:
            - origin.port
            - target.port
          to: int
      # Removing unused fields
      - delete:
          fields:
            - log.firePowerHeader
            - log.ciscoSeparator
            - log.irrelevant
            - log.syslogPri
            - log.rest'
	WHERE id=303;
            ]]>
        </sql>
    </changeSet>
</databaseChangeLog>
