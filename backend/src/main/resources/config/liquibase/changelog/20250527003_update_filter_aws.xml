<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <changeSet id="20250527002" author="JocLRojas">

        <sql dbms="postgresql" splitStatements="true" stripComments="true">
            <![CDATA[

            UPDATE public.utm_logstash_filter
            SET filter_version='1.0.0',
	          logstash_filter='# AWS filter, version 1.0.0

pipeline:
  - dataTypes:
      - aws
    steps:
      - json:
          source: raw

      - rename:
          from:
            - log.userIdentity.accessKeyId
          to: log.userIdentityAccessKeyId

      - rename:
          from:
            - log.userIdentity.accountId
          to: log.userIdentityAccountId

      - rename:
          from:
            - log.userIdentity.arn
          to: log.userIdentityArn

      - rename:
          from:
            - log.userIdentity.invokedBy
          to: log.userIdentityInvokedBy

      - rename:
          from:
            - log.userIdentity.principalId
          to: log.userIdentityPrincipalId

      - rename:
          from:
            - log.userIdentity.sessionContext.attributes.creationDate
          to: log.userIdentitySessionContextAttributesCreationDate

      - rename:
          from:
            - log.userIdentity.sessionContext.attributes.mfaAuthenticated
          to: log.userIdentitySessionContextAttributesMfaAuthenticated

      - rename:
          from:
            - log.userIdentity.sessionContext.sessionIssuer.accountId
          to: log.userIdentitySessionContextSessionIssuerAccountId

      - rename:
          from:
            - log.userIdentity.sessionContext.sessionIssuer.arn
          to: log.userIdentitySessionContextSessionIssuerArn

      - rename:
          from:
            - log.userIdentity.sessionContext.sessionIssuer.principalId
          to: log.userIdentitySessionContextSessionIssuerPrincipalId

      - rename:
          from:
            - log.userIdentity.sessionContext.sessionIssuer.type
          to: log.userIdentitySessionContextSessionIssuerType

      - rename:
          from:
            - log.userIdentity.sessionContext.sessionIssuer.userName
          to: log.userIdentitySessionContextSessionIssuerUserName

      - rename:
          from:
            - log.userIdentity.sessionContext.webIdFederationData
          to: log.userIdentitySessionContextWebIdFederationData

      - rename:
          from:
            - log.userIdentity.type
          to: log.userIdentityType

      - rename:
          from:
            - log.requestParameters.durationSeconds
          to: log.requestParametersDurationSeconds

      - rename:
          from:
            - log.requestParameters.roleArn
          to: log.requestParametersRoleArn

      - rename:
          from:
            - log.requestParameters.roleSessionName
          to: log.requestParametersRoleSessionName

      - rename:
          from:
            - log.responseElements.assumedRoleUser.arn
          to: log.responseElementsAssumedRoleUserArn

      - rename:
          from:
            - log.responseElements.assumedRoleUser.assumedRoleId
          to: log.responseElementsAssumedRoleUserAssumedRoleId

      - rename:
          from:
            - log.responseElements.credentials.accessKeyId
          to: log.responseElementsCredentialsAccessKeyId

      - rename:
          from:
            - log.responseElements.credentials.expiration
          to: log.responseElementsCredentialsExpiration

      - rename:
          from:
            - log.responseElements.credentials.sessionToken
          to: log.responseElementsCredentialsSessionToken

      - rename:
          from:
            - log.requestParameters.Host
          to: log.requestParametersHost

      - rename:
          from:
            - log.requestParameters.acl
          to: log.requestParametersAcl

      - rename:
          from:
            - log.requestParameters.bucketName
          to: log.userIdentityAccesrequestParametersBucketNamesKeyId

      - rename:
          from:
            - log.additionalEventData.SignatureVersion
          to: log.additionalEventDataSignatureVersion

      - rename:
          from:
            - log.additionalEventData.AuthenticationMethod
          to: log.additionalEventDataAuthenticationMethod

      - rename:
          from:
            - log.additionalEventData.CipherSuite
          to: log.additionalEventDataCipherSuite

      - rename:
          from:
            - log.additionalEventData.bytesTransferredIn
          to: origin.bytesReceived

      - rename:
          from:
            - log.additionalEventData.bytesTransferredOut
          to: origin.bytesSent

      - rename:
          from:
            - log.additionalEventData.x-amz-id-2
          to: log.additionalEventDataXamzId2

      - rename:
          from:
            - log.additionalEventData.SSEApplied
          to: log.additionalEventDataSSEApplied

      - rename:
          from:
            - log.requestParameters.key
          to: log.requestParametersKey

      - rename:
          from:
            - log.requestParameters.x-amz-acl
          to: log.requestParametersXAmzAcl

      - rename:
          from:
            - log.requestParameters.x-amz-server-side-encryption
          to: log.requestParametersXAmzServerSideEncryption

      - rename:
          from:
            - log.responseElements.x-amz-expiration
          to: log.responseElementsXAmzExpiration

      - rename:
          from:
            - log.responseElements.x-amz-server-side-encryption
          to: log.responseElementsXAmzServerSideEncryption

      - rename:
          from:
            - log.responseElements.assumedRoleUser
          to: log.responseElementsAssumedRoleUser

      - rename:
          from:
            - log.responseElements.credentials
          to: log.responseElementsCredentials

      - rename:
          from:
            - log.tlsDetails.cipherSuite
          to: log.tlsDetailsCipherSuite

      - rename:
          from:
            - log.tlsDetails.clientProvidedHostHeader
          to: log.tlsDetailsClientProvidedHostHeader

      - rename:
          from:
            - log.tlsDetails.tlsVersion
          to: log.tlsDetailsTlsVersion

      # Drop unnecessary events
      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="dynamodb.amazonaws.com" && (name=="PutItem || name=="GetItem || name=="ListTables")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="lambda.amazonaws.com" && name=="Invoke"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="s3.amazonaws.com" && (name=="ListBuckets" || name=="ListAccessPoints" || name=="ListStorageLensConfigurations" || name=="PutBucketPolicy" || name=="PutObject" || name=="GetObject" || name=="DeleteObject")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="sns.amazonaws.com" && (name=="ListTopics" || name=="Publish" || name=="PublishBatch")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="cloudtrail.amazonaws.com" && (name=="ListTrails" || name=="StartLogging" || name=="GetInsightSelectors" || name=="ListInsightsEvents" || name=="LookupEvents" || name=="StopLogging" || name=="DescribeTrails")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="airflow.amazonaws.com" && name=="ListEnvironments"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="amazonmq.amazonaws.com" && name=="ListBrokers"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="amplify.amazonaws.com" && name=="ListApps"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="apigateway.amazonaws.com" && name=="GetRestApis"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="app-integrations.amazonaws.com" && name=="ListEventIntegrations"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="appflow.amazonaws.com" && name=="ListFlows"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="appmesh.amazonaws.com" && name=="ListMeshes"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="apprunner.amazonaws.com" && name=="ListServices"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="appstream.amazonaws.com" && (name=="DescribeImageBuilders" || name=="DescribeFleets" || name=="DescribeApplications" || name=="DescribeStacks")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="appsync.amazonaws.com" && name=="ListGraphqlApis"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="athena.amazonaws.com" && (name=="ListWorkGroups" || name=="ListDataCatalogs")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="auditmanager.amazonaws.com" && name=="GetAccountStatus"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="backup.amazonaws.com" && (name=="RecoveryPointCreated" || name=="BackupJobCompleted" || name=="ListBackupVaults" || name=="ListBackupPlans" || name=="BackupJobStarted" || name=="BackupJobCompleted")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="batch.amazonaws.com" && (name=="DescribeComputeEnvironments" || name=="ListSchedulingPolicies" || name=="DescribeJobQueues")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="cloudformation.amazonaws.com" && (name=="ListStacks" || name=="ListStackSets")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="cloudfront.amazonaws.com" && (name=="ListCloudFrontOriginAccessIdentities" || name=="ListResponseHeadersPolicies" || name=="ListCachePolicies")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="codeartifact.amazonaws.com" && (name=="ListDomains" || name=="ListRepositories")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="codebuild.amazonaws.com" && name=="ListProjects"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="codecommit.amazonaws.com" && name=="ListRepositories"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="codeguru-profiler.amazonaws.com" && name=="ListProfilingGroups"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="codeguru-reviewer.amazonaws.com" && name=="ListRepositoryAssociations"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="codepipeline.amazonaws.com" && (name=="ListPipelines" || name=="ListWebhooks")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="cognito-identity.amazonaws.com" && name=="ListIdentityPools"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="comprehend.amazonaws.com" && (name=="ListDocumentClassifiers" || name=="ListEntityRecognizers")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="connect.amazonaws.com" && name=="ListInstances"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="databrew.amazonaws.com" && (name=="ListDatasets" || name=="ListSchedules" || name=="ListJobs" || name=="ListRecipes" || name=="ListProjects" || name=="ListRulesets")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="dataexchange.amazonaws.com" && name=="ListDataSets"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="datasync.amazonaws.com" && (name=="ListLocations" || name=="ListTasks")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="detective.amazonaws.com" && name=="ListGraphs"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="dms.amazonaws.com" && (name=="DescribeReplicationSubnetGroups" || name=="DescribeEndpoints" || name=="DescribeEventSubscriptions" || name=="DescribeReplicationInstances" || name=="DescribeReplicationTasks")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ec2.amazonaws.com" && (name=="DescribeInstances" || name=="StartInstances" || name=="StopInstances" || name=="RebootInstances" || name=="DescribeVpcs" || name=="DescribeReservedInstances" || name=="DescribeCapacityReservations" || name=="DescribeEgressOnlyInternetGateways" || name=="DescribeSpotInstanceRequests" || name=="DescribeSubnets" || name=="DescribeIpamScopes" || name=="DescribeVerifiedAccessInstances" || name=="DescribeLaunchTemplates" || name=="DescribePlacementGroups" || name=="DescribeVpcEndpoints" || name=="DescribeSpotFleetRequests" || name=="DescribeManagedPrefixLists" || name=="DescribeVerifiedAccessEndpoints" || name=="DescribeKeyPairs" || name=="DescribeTransitGatewayMulticastDomains" || name=="DescribeInstanceEventWindows" || name=="DescribeFlowLogs" || name=="DescribeIpams" || name=="DescribeTransitGatewayPolicyTables" || name=="DescribePublicIpv4Pools" || name=="DescribeTrafficMirrorTargets" || name=="DescribeCustomerGateways" || name=="DescribeTrafficMirrorFilters" || name=="DescribeDhcpOptions" || name=="DescribeVolumes" || name=="DescribeTransitGatewayConnectPeers" || name=="DescribeTrafficMirrorSessions" || name=="DescribeFpgaImages" || name=="DescribeSnapshots" || name=="DescribeNetworkInsightsAnalyses" || name=="DescribeNetworkInsightsAccessScopes" || name=="DescribeFleets" || name=="DescribeTransitGatewayAttachments" || name=="DescribeNetworkInterfaces" || name=="DescribeImages" || name=="DescribeTransitGatewayRouteTableAnnouncements" || name=="DescribeNetworkInsightsAccessScopeAnalyses" || name=="DescribeCarrierGateways" || name=="DescribeNatGateways" || name=="DescribeTransitGateways" || name=="DescribeRouteTables" || name=="DescribeHosts" || name=="DescribeHostReservations" || name=="DescribeVpcPeeringConnections" || name=="DescribeCapacityReservationFleets" || name=="DescribeTransitGatewayRouteTables" || name=="DescribeIpamPools" || name=="DescribeNetworkInsightsPaths" || name=="DescribeClientVpnEndpoints" || name=="GetSubnetCidrReservations" || name=="DescribeVerifiedAccessGroups")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ecs.amazonaws.com" && name=="DescribeCapacityProviders"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="elasticache.amazonaws.com" && (name=="DescribeReplicationGroups" || name=="DescribeSnapshots" || name=="DescribeCacheSubnetGroups" || name=="DescribeCacheParameterGroups" || name=="DescribeReservedCacheNodes")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="elasticbeanstalk.amazonaws.com" && (name=="DescribeApplications || name=="DescribeEnvironments" || name=="DescribeApplicationVersions" || name=="DescribeAccessPoints" || name=="DescribeTags")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="elasticloadbalancing.amazonaws.com" && (name=="DescribeLoadBalancers" || name=="DescribeTargetGroups")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="elasticmapreduce.amazonaws.com" && name=="ListClusters"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="emr-containers.amazonaws.com" && name=="ListVirtualClusters"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="events.amazonaws.com" && (name=="ListEventBuses" || name=="ListRules")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="evidently.amazonaws.com" && name=="ListProjects"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="finspace.amazonaws.com" && name=="ListEnvironments"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="firehose.amazonaws.com" && name=="ListDeliveryStreams"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="forecast.amazonaws.com" && (name=="ListDatasets" || name=="ListDatasetGroups")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="frauddetector.amazonaws.com" && (name=="GetModels" || name=="GetLabels" || name=="GetExternalModels" || name=="GetVariables" || name=="GetEventTypes")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="fsx.amazonaws.com" && name=="DescribeFileSystems"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="gamelift.amazonaws.com" && (name=="DescribeGameSessionQueues" || name=="DescribeMatchmakingConfigurations" || name=="ListAliases" || name=="ListBuilds")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="geo.amazonaws.com" && (name=="ListPlaceIndexes" || name=="ListTrackers")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="glacier.amazonaws.com" && name=="ListVaults"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="globalaccelerator.amazonaws.com" && name=="ListAccelerators"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="glue.amazonaws.com" && (name=="GetJobs" || name=="GetDatabases" || name=="ListMLTransforms" || name=="GetTriggers" || name=="GetCrawlers")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="greengrass.amazonaws.com" && (name=="ListComponents" || name=="ListSubscriptionDefinitions" || name=="ListLoggerDefinitions" || name=="ListDeviceDefinitions" || name=="ListCoreDefinitions" || name=="ListConnectorDefinitions" || name=="ListResourceDefinitions" || name=="ListFunctionDefinitions" || name=="ListGroups")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="groundstation.amazonaws.com" && name=="ListConfigs"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="guardduty.amazonaws.com" && name=="ListDetectors"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="healthlake.amazonaws.com" && name=="ListFHIRDatastores"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="imagebuilder.amazonaws.com" && (name=="ListInfrastructureConfigurations" || name=="ListComponents" || name=="ListContainerRecipes" || name=="ListDistributionConfigurations" || name=="ListImageRecipes" || name=="ListImages" || name=="ListImagePipelines")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="iot.amazonaws.com" && (name=="ListRoleAliases" || name=="ListPolicies" || name=="ListJobTemplates" || name=="ListProvisioningTemplates" || name=="ListAuthorizers" || name=="ListMitigationActions" || name=="ListThings")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="iotanalytics.amazonaws.com" && (name=="ListChannels" || name=="ListPipelines" || name=="ListDatastores" || name=="ListDatasets")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="iotevents.amazonaws.com" && (name=="ListAlarmModels" || name=="ListDetectorModels")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="iotsitewise.amazonaws.com" && (name=="ListAssetModels" || name=="ListPortals" || name=="ListGateways")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="iottwinmaker.amazonaws.com" && name=="ListWorkspaces"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="iotwireless.amazonaws.com" && name=="ListServiceProfiles"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ivs.amazonaws.com" && name=="ListChannels"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="kafka.amazonaws.com" && (name=="ListClusters" || name=="ListConfigurations")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="kendra.amazonaws.com" && name=="ListIndices"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="kinesisanalytics.amazonaws.com" && name=="ListApplications"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="kinesisvideo.amazonaws.com" && name=="ListStreams"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="kms.amazonaws.com" && name=="Decrypt"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="lambda.amazonaws.com" && (name=="ListFunctions20150331" || name=="ListEventSourceMappings20150331" || name=="ListCodeSigningConfigs")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="lex.amazonaws.com" && name=="ListBots"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="logs.amazonaws.com" && (name=="GetLogEvents" || name=="DescribeLogStreams" || name=="DescribeLogGroups" || name=="DescribeDestinations")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="lookoutmetrics.amazonaws.com" && name=="ListAlerts"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="mediapackage.amazonaws.com" && (name=="ListChannels" || name=="ListPackagingConfigurations" || name=="ListOriginEndpoints" || name=="ListPackagingGroups")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="mediatailor.amazonaws.com" && name=="ListPlaybackConfigurations"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="memorydb.amazonaws.com" && (name=="DescribeSubnetGroups" || name=="DescribeACLs" || name=="DescribeParameterGroups" || name=="DescribeClusters")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="monitoring.amazonaws.com" && (name=="DescribeAlarms" || name=="ListDashboards" || name=="ListMetricStreams" || name=="DescribeInsightRules")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="networkmanager.amazonaws.com" && (name=="DescribeGlobalNetworks" || name=="ListAttachments")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="panorama.amazonaws.com" && name=="ListPackages"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="personalize.amazonaws.com" && (name=="ListSchemas" || name=="ListDatasets")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="pinpoint.amazonaws.com" && name=="GetApps"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="proton.amazonaws.com" && name=="ListEnvironmentAccountConnections"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="qconnect.amazonaws.com" && name=="ListAssistants"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="qldb.amazonaws.com" && name=="ListLedgers"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="quicksight.amazonaws.com" && name=="DescribeAccountSubscription"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ram.amazonaws.com" && name=="GetResourceShares"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="rds.amazonaws.com" && (name=="DescribeDBInstances" || name=="DescribeEventCategories" || name=="FailoverDBCluster" || name=="CreateDBSnapshot || name=="DescribeDBClusterParameterGroups" || name=="DescribeOptionGroups" || name=="DescribeDBSubnetGroups" || name=="DescribeDBClusters" || name=="DescribeDBClusterSnapshots" || name=="DescribeEventSubscriptions" || name=="DescribeDBSnapshots" || name=="DescribeDBParameterGroups" || name=="DescribeBlueGreenDeployments" || name=="DescribeDBEngineVersions" || name=="DescribeDBInstanceAutomatedBackups" || name=="DescribeReservedDBInstances" || name=="DescribeDBClusterEndpoints" || name=="DescribeDBProxies" || name=="DescribeDBProxyEndpoints")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="redshift.amazonaws.com" && (name=="DescribeUsageLimits" || name=="DescribeClusters" || name=="DescribeClusterSnapshots" || name=="DescribeEventSubscriptions" || name=="DescribeClusterSubnetGroups" || name=="DescribeSnapshotSchedules" || name=="DescribeSnapshotCopyGrants" || name=="DescribeClusterParameterGroups")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="refactor-spaces.amazonaws.com" && name=="ListEnvironments"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="rekognition.amazonaws.com" && name=="DescribeProjects"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="resiliencehub.amazonaws.com" && name=="ListResiliencyPolicies"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="resource-explorer-2.amazonaws.com" && (name=="GetIndex" || name=="ListViews")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="route53resolver.amazonaws.com" && (name=="ListResolverQueryLogConfigs" || name=="ListFirewallRuleGroups" || name=="ListResolverRules" || name=="ListResolverEndpoints" || name=="ListFirewallDomainLists")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="sagemaker.amazonaws.com" && (name=="CreatePipeline" || name=="ListModels" || name=="ListPipelines" || name=="ListEndpoints" || name=="ListImages" || name=="ListNotebookInstances" || name=="ListFeatureGroups")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="servicecatalog-appregistry.amazonaws.com" && (name=="ListAttributeGroups" || name=="ListApplications")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ses.amazonaws.com" && (name=="ListConfigurationSets" || name=="ListEmailIdentities" || name=="ListContactLists")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="signer.amazonaws.com" && name=="ListSigningProfiles"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ssm.amazonaws.com" && (name=="DescribeParameters" || name=="ListDocuments" || name=="DescribeMaintenanceWindows" || name=="ListAssociations" || name=="ListResourceDataSync" || name=="DescribeInstanceInformation")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="states.amazonaws.com" && (name=="ListStateMachines" || name=="ListActivities")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="sts.amazonaws.com" && name=="AssumeRole"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="tagging.amazonaws.com" && name=="GetResources"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="transfer.amazonaws.com" && name=="ListWorkflows"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="workspaces.amazonaws.com" && name=="DescribeWorkspaces"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ecr.amazonaws.com" && name=="DescribeRepositories"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="ecs.amazonaws.com" && name=="ListClusters"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="eks.amazonaws.com" && name=="ListClusters"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="elasticache.amazonaws.com" && name=="DescribeCacheClusters"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="elasticfilesystem.amazonaws.com" && name=="DescribeFileSystems"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="emr-containers.amazonaws.com" && name=="ListJobs"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="emr-serverless.amazonaws.com" && name=="ListApplications"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="emr.amazonaws.com" && name=="ListClusters"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="guardduty.amazonaws.com" && name=="GetFindings"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="codecommit.amazonaws.com" && name=="CreateRepository"

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="cognito-identity.amazonaws.com" && (name=="GetOpenIdToken" || name=="ListIdentities")

      - drop:
          where:
            variables:
              - get: log.eventSource
                as: source
                oftype: string
              - get: log.eventName
                as: name
                oftype: string
            expression: source=="iam.amazonaws.com" && name=="ListPolicies"

      - delete:
          fields:
            - log.requestParameters
            - log.responseElements
            - log.userIdentity
            - log.additionalEventData'
	WHERE id=1527;
            ]]>
        </sql>
    </changeSet>
</databaseChangeLog>
