<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <changeSet id="20250507045" author="JocLRojas">

        <sql dbms="postgresql" splitStatements="true" stripComments="true">
            <![CDATA[

            UPDATE public.utm_logstash_filter
            SET filter_version='2.0.0',
            logstash_filter='# GCP filter, version 2.0.0
# 
# Documentations
# 1- https://cloud.google.com/logging/docs/reference/v2/rest/v2/LogEntry

pipeline:
  - dataTypes:
      - google
    steps:
      - json:
          source: raw

      # .......................................................................#
      # Rename to utmstack format to normalize fields
      # .......................................................................#
      # Renaming httpRequest fields
      # .......................................................................#
      - rename:
          from:
            - log.httpRequest.cacheHit
          to: log.httpRequestCacheHit

      - rename:
          from:
            - log.httpRequest.cacheLookup
          to: log.httpRequestCacheLookup

      - rename:
          from:
            - log.httpRequest.latency
          to: log.httpRequestLatency

      - rename:
          from:
            - log.httpRequest.remoteIp
          to: origin.ip

      - rename:
          from:
            - log.httpRequest.requestMethod
          to: log.httpRequestMethod

      - rename:
          from:
            - log.httpRequest.requestSize
          to: origin.bytesSent

      - rename:
          from:
            - log.httpRequest.requestUrl
          to: target.url

      - rename:
          from:
            - log.httpRequest.responseSize
          to: target.bytesSent

      - rename:
          from:
            - log.httpRequest.status
          to: statusCode

      - rename:
          from:
            - log.httpRequest.userAgent
          to: log.httpUserAgent

      # .......................................................................#
      # Renaming jsonPayload fields
      # .......................................................................#
      - rename:
          from:
            - log.jsonPayload.type
          to: log.jsonPayloadType

      - rename:
          from:
            - log.jsonPayload.backendTargetProjectNumber
          to: log.jsonPayloadBackendTargetProjectNumber

      - rename:
          from:
            - log.jsonPayload.cacheDecision
          to: log.jsonPayloadCacheDecision

      - rename:
          from:
            - log.jsonPayload.cacheId
          to: log.jsonPayloadCacheId

      - rename:
          from:
            - log.jsonPayload.enforcedEdgeSecurityPolicy.configuredAction
          to: log.jsonPayloadEnforcedEdgeSecurityPolicyConfiguredAction

      - rename:
          from:
            - log.jsonPayload.enforcedEdgeSecurityPolicy.name
          to: log.jsonPayloadEnforcedEdgeSecurityPolicyName

      - rename:
          from:
            - log.jsonPayload.enforcedEdgeSecurityPolicy.outcome
          to: log.jsonPayloadEnforcedEdgeSecurityPolicyOutcome

      - rename:
          from:
            - log.jsonPayload.enforcedEdgeSecurityPolicy.priority
          to: log.jsonPayloadEnforcedEdgeSecurityPolicyPriority

      - rename:
          from:
            - log.jsonPayload.remoteIp
          to: log.jsonPayloadRemoteIp

      - rename:
          from:
            - log.jsonPayload.statusDetails
          to: log.jsonPayloadStatusDetails

      - rename:
          from:
            - log.jsonPayload.authAnswer
          to: log.JsonPayloadAuthAnswer

      - rename:
          from:
            - log.jsonPayload.destinationIP
          to: target.ip

      - rename:
          from:
            - log.jsonPayload.dns64Translated
          to: log.jsonPayloadDns64Translated

      - rename:
          from:
            - log.jsonPayload.protocol
          to: protocol

      - rename:
          from:
            - log.jsonPayload.queryName
          to: origin.domain

      - rename:
          from:
            - log.jsonPayload.queryType
          to: log.jsonPayloadQueryType

      - rename:
          from:
            - log.jsonPayload.responseCode
          to: log.jsonPayloadResponseCode

      - rename:
          from:
            - log.jsonPayload.serverLatency
          to: log.jsonPayloadServerLatency

      - rename:
          from:
            - log.jsonPayload.sourceIP
          to: origin.ip

      # Expand jsonPayload.structuredRdata
      - expand:
          source: log.jsonPayload.structuredRdata
          to: log.jsonPayloadStructuredRdata
          where:
            variables:
              - get: log.jsonPayload.structuredRdata
                as: rdata
                ofType: string
            expression: rdata_ok==true

      # Parsing log.jsonPayloadStructuredRdata
      - json:
          source: log.jsonPayloadStructuredRdata
          where:
            variables:
              - get: log.jsonPayloadStructuredRdata
                as: rdata
                ofType: string
            expression: rdata_ok==true

      - rename:
          from:
            - log.class
          to: log.dnsQuery.class

      - rename:
          from:
            - log.domainName
          to: log.dnsQuery.domain

      - rename:
          from:
            - log.rvalue
          to: log.dnsQuery.rValue

      - rename:
          from:
            - log.ttl
          to: log.dnsQuery.ttl

      - rename:
          from:
            - log.type
          to: log.dnsQuery.type

      # .......................................................................#
      # Renaming resource fields
      # .......................................................................#
      - rename:
          from:
            - log.resource.labels.backend_service_name
          to: log.resourceLabelsBackendServiceName

      - rename:
          from:
            - log.resource.labels.forwarding_rule_name
          to: log.resourceLabelsForwardingRuleName

      - rename:
          from:
            - log.resource.labels.project_id
          to: log.resourceLabelsProjectId

      - rename:
          from:
            - log.resource.labels.target_proxy_name
          to: log.resourceLabelsTargetProxyName

      - rename:
          from:
            - log.resource.labels.url_map_name
          to: log.resourceLabelsUrlMapName

      - rename:
          from:
            - log.resource.labels.zone
          to: log.resourceLabelsZone

      - rename:
          from:
            - log.resource.labels.location
          to: log.resourceLabelsLocation

      - rename:
          from:
            - log.resource.labels.projectId
          to: log.resourceLabelsProjectId

      - rename:
          from:
            - log.resource.labels.projectType
          to: log.resourceLabelsProjectType

      - rename:
          from:
            - log.resource.labels.targetName
          to: log.resourceLabelsTargetName

      - rename:
          from:
            - log.resource.labels.targetType
          to: log.resourceLabelsTargetType

      - rename:
          from:
            - log.resource.type
          to: log.resourceType

      # .......................................................................#
      # Renaming operation field
      # .......................................................................#
      - rename:
          from:
            - log.operation.id
          to: log.operationId

      - rename:
          from:
            - log.operation.producer
          to: log.operationProducer

      - rename:
          from:
            - log.operation.first
          to: log.operationFirst

      - rename:
          from:
            - log.operation.last
          to: log.operationLast

      # .......................................................................#
      # Renaming sourceLocation field
      # .......................................................................#
      - rename:
          from:
            - log.sourceLocation.file
          to: log.sourceLocationFile

      - rename:
          from:
            - log.sourceLocation.line
          to: log.sourceLocationLine

      - rename:
          from:
            - log.sourceLocation.function
          to: log.sourceLocationFunction

      # Fields conversions
      - cast:
          fields:
            - log.jsonPayloadCacheDecision
          to: ''[]string''

      - cast:
          fields:
            - statusCode
          to: int

      # Adding action field based on log.httpRequestMethod
      - add:
          function: ''string''
          params:
            key: action
            value: ''get''
          where:
            variables:
              - get: log.httpRequestMethod
                as: action
                ofType: string
            expression: action_ok==true && action=="GET"

      - add:
          function: ''string''
          params:
            key: action
            value: ''post''
          where:
            variables:
              - get: log.httpRequestMethod
                as: action
                ofType: string
            expression: action_ok==true && action=="POST"

      - add:
          function: ''string''
          params:
            key: action
            value: ''put''
          where:
            variables:
              - get: log.httpRequestMethod
                as: action
                ofType: string
            expression: action_ok==true && action=="PUT"

      - add:
          function: ''string''
          params:
            key: action
            value: ''patch''
          where:
            variables:
              - get: log.httpRequestMethod
                as: action
                ofType: string
            expression: action_ok==true && action=="PATCH"

      - add:
          function: ''string''
          params:
            key: action
            value: ''request''
          where:
            variables:
              - get: log.httpRequestMethod
                as: action
                ofType: string
            expression: action_ok==true && action=="REQUEST"

      - add:
          function: ''string''
          params:
            key: action
            value: ''delete''
          where:
            variables:
              - get: log.httpRequestMethod
                as: action
                ofType: string
            expression: action_ok==true && action=="DELETE"

      # Adding actionResult field based on log.jsonPayloadEnforcedEdgeSecurityPolicyOutcome
      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''accepted''
          where:
            variables:
              - get: log.jsonPayloadEnforcedEdgeSecurityPolicyOutcome
                as: actionResult
                ofType: string
            expression: actionResult_ok==true && actionResult=="ACCEPT"

      - add:
          function: ''string''
          params:
            key: actionResult
            value: ''denied''
          where:
            variables:
              - get: log.jsonPayloadEnforcedEdgeSecurityPolicyOutcome
                as: actionResult
                ofType: string
            expression: actionResult_ok==true && actionResult=="DENY"

      # Adding severity field based on log.severity
      - add:
          function: ''string''
          params:
            key: severity
            value: ''low''
          where:
            variables:
              - get: log.severity
                as: severity
                ofType: string
            expression: severity_ok==true && (severity=="INFO" || severity=="NOTICE")

      - add:
          function: ''string''
          params:
            key: severity
            value: ''medium''
          where:
            variables:
              - get: log.severity
                as: severity
                ofType: string
            expression: severity_ok==true && severity=="WARNING"

      - add:
          function: ''string''
          params:
            key: severity
            value: ''high''
          where:
            variables:
              - get: log.severity
                as: severity
                ofType: string
            expression: severity_ok==true && severity=="ERROR"

      # Adding geolocation to origin.ip
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: origin.ip
            destination: origin.geolocation
          where:
            variables:
              - get: origin.ip
                as: ip
                ofType: string
            expression: ip_ok==true

      # Adding geolocation to target.ip
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: target.ip
            destination: target.geolocation
          where:
            variables:
              - get: target.ip
                as: ip
                ofType: string
            expression: ip_ok==true

      # -------------------------------------------------------------------------------
      # Access Context Manager audit logging
      # -------------------------------------------------------------------------------
      # ADMIN_READ
      # -------------------------------------------------------------------------------
      # google.identity.accesscontextmanager.v1.AccessContextManager.GetAccessLevel
      # google.identity.accesscontextmanager.v1.AccessContextManager.GetAccessPolicy
      # google.identity.accesscontextmanager.v1.AccessContextManager.GetAuthorizedOrgsDesc
      # google.identity.accesscontextmanager.v1.AccessContextManager.GetGcpUserAccessBinding
      # google.identity.accesscontextmanager.v1.AccessContextManager.GetIamPolicy
      # google.identity.accesscontextmanager.v1.AccessContextManager.GetServicePerimeter
      # google.identity.accesscontextmanager.v1.AccessContextManager.ListAccessLevels
      # google.identity.accesscontextmanager.v1.AccessContextManager.ListAccessPolicies
      # google.identity.accesscontextmanager.v1.AccessContextManager.ListAuthorizedOrgsDescs
      # google.identity.accesscontextmanager.v1.AccessContextManager.ListGcpUserAccessBindings
      # google.identity.accesscontextmanager.v1.AccessContextManager.ListServicePerimeters
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.GetAccessLevel
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.GetAccessPolicy
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.GetAuthorizedOrgsDesc
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.GetGcpUserAccessBinding
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.GetIamPolicy
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.GetServicePerimeter
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.ListAccessPolicies
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.ListGcpUserAccessBindings
      # google.identity.accesscontextmanager.v1alpha.AccessContextManager.ListServicePerimeters
      # google.longrunning.Operations.GetOperation
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="accesscontextmanager.googleapis.com" &&
                        (methodName.contains("GetAccessLevel") ||
                        methodName.contains("GetAccessPolicy") ||
                        methodName.contains("GetAuthorizedOrgsDesc") ||
                        methodName.contains("GetGcpUserAccessBinding") ||
                        methodName.contains("GetIamPolicy") ||
                        methodName.contains("GetServicePerimeter") ||
                        methodName.contains("ListAccessLevels") ||
                        methodName.contains("ListAccessPolicies") ||
                        methodName.contains("ListAuthorizedOrgsDescs") ||
                        methodName.contains("ListGcpUserAccessBindings") ||
                        methodName.contains("ListServicePerimeters"))

      # -------------------------------------------------------------------------------
      # Advisory Notifications audit logging
      # -------------------------------------------------------------------------------
      # ADMIN_READ
      # -------------------------------------------------------------------------------
      # google.cloud.advisorynotifications.v1.AdvisoryNotificationsService.GetNotification
      # google.cloud.advisorynotifications.v1.AdvisoryNotificationsService.ListNotifications
      # google.cloud.advisorynotifications.v1alpha.AdvisoryNotificationsService.GetSettings
      # google.cloud.advisorynotifications.v1beta.AdvisoryNotificationsService.GetNotification
      # google.cloud.advisorynotifications.v1beta.AdvisoryNotificationsService.ListNotifications
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="advisorynotifications.googleapis.com" &&
                        (methodName.contains("GetNotification") ||
                        methodName.contains("ListNotifications"))
      
      # -------------------------------------------------------------------------------
      # AlloyDB for PostgreSQL audit logging
      # -------------------------------------------------------------------------------
      # ADMIN_READ
      # -------------------------------------------------------------------------------
      # google.cloud.alloydb.v1.AlloyDBAdmin.GetBackup
      # google.cloud.alloydb.v1.AlloyDBAdmin.GetCluster
      # google.cloud.alloydb.v1.AlloyDBAdmin.GetInstance
      # google.cloud.alloydb.v1.AlloyDBAdmin.GetUser
      # google.cloud.alloydb.v1.AlloyDBAdmin.ListBackups
      # google.cloud.alloydb.v1.AlloyDBAdmin.ListClusters
      # google.cloud.alloydb.v1.AlloyDBAdmin.ListDatabases
      # google.cloud.alloydb.v1.AlloyDBAdmin.ListInstances
      # google.cloud.alloydb.v1.AlloyDBAdmin.ListUsers
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.GetBackup
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.GetCluster
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.GetInstance
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.GetUser
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.ListBackups
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.ListClusters
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.ListInstances
      # google.cloud.alloydb.v1alpha.AlloyDBAdmin.ListUsers
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.GetBackup
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.GetCluster
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.GetInstance
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.GetUser
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.ListBackups
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.ListClusters
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.ListDatabases
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.ListInstances
      # google.cloud.alloydb.v1beta.AlloyDBAdmin.ListUsers
      # google.longrunning.Operations.GetOperation
      # google.longrunning.Operations.ListOperations
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="alloydb.googleapis.com" &&
                        (methodName.contains("GetBackup") ||
                        methodName.contains("GetCluster") ||
                        methodName.contains("GetInstance") ||
                        methodName.contains("GetUser") ||
                        methodName.contains("ListBackups") ||
                        methodName.contains("ListClusters") ||
                        methodName.contains("ListDatabases") ||
                        methodName.contains("ListInstances") ||
                        methodName.contains("ListUsers"))

      # -------------------------------------------------------------------------------
      # Analytics Hub audit logging
      # -------------------------------------------------------------------------------
      # ADMIN_READ
      # -------------------------------------------------------------------------------
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.GetDataExchange
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.GetIamPolicy
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.GetListing
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.GetSubscription
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.ListDataExchanges
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.ListListings
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.ListOrgDataExchanges
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.ListSharedResourceSubscriptions
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.ListSubscriptions
      # google.cloud.bigquery.analyticshub.v1.AnalyticsHubService.SubscribeListing
      # google.cloud.bigquery.dataexchange.v1beta1.AnalyticsHubService.GetDataExchange
      # google.cloud.bigquery.dataexchange.v1beta1.AnalyticsHubService.GetIamPolicy
      # google.cloud.bigquery.dataexchange.v1beta1.AnalyticsHubService.GetListing
      # google.cloud.bigquery.dataexchange.v1beta1.AnalyticsHubService.ListDataExchanges
      # google.cloud.bigquery.dataexchange.v1beta1.AnalyticsHubService.ListListings
      # google.cloud.bigquery.dataexchange.v1beta1.AnalyticsHubService.ListOrgDataExchanges
      # google.cloud.bigquery.dataexchange.v1beta1.AnalyticsHubService.SubscribeListing
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="analyticshub.googleapis.com" &&
                        (methodName.contains("GetDataExchange") ||
                        methodName.contains("GetIamPolicy") ||
                        methodName.contains("GetListing") ||
                        methodName.contains("GetSubscription") ||
                        methodName.contains("ListDataExchanges") ||
                        methodName.contains("ListListings") ||
                        methodName.contains("ListOrgDataExchanges") ||
                        methodName.contains("ListSharedResourceSubscriptions") ||
                        methodName.contains("ListSubscriptions") ||
                        methodName.contains("SubscribeListing"))

      # -------------------------------------------------------------------------------
      # Audit logging for Android Device Streaming
      # -------------------------------------------------------------------------------
      # ADMIN_READ
      # -------------------------------------------------------------------------------
      # google.devtools.testing.v1.DirectAccessService.GetDeviceSession
      # google.devtools.testing.v1.DirectAccessService.ListDeviceSessions
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="androiddevicestreaming.googleapis.com" &&
                        (methodName.contains("GetDeviceSession") ||
                        methodName.contains("ListDeviceSessions"))

      
      # --------------------------------------------------------------------------------
      # Drop ApiGateway logs inuse fields
      # --------------------------------------------------------------------------------
      # GetIamPolicy
      # --------------------------------------------------------------------------------
      # google.cloud.apigateway.v1.ApiGatewayService.GetApi
      # google.cloud.apigateway.v1.ApiGatewayService.GetApiConfig
      # google.cloud.apigateway.v1.ApiGatewayService.GetGateway
      # google.cloud.apigateway.v1.ApiGatewayService.ListApiConfigs
      # google.cloud.apigateway.v1.ApiGatewayService.ListApis
      # google.cloud.apigateway.v1.ApiGatewayService.ListGateways
      # google.cloud.apigateway.v1beta.ApiGatewayService.GetApi
      # google.cloud.apigateway.v1beta.ApiGatewayService.GetApiConfig
      # google.cloud.apigateway.v1beta.ApiGatewayService.GetGateway
      # google.cloud.apigateway.v1beta.ApiGatewayService.ListApiConfigs
      # google.cloud.apigateway.v1beta.ApiGatewayService.ListApis
      # google.cloud.apigateway.v1beta.ApiGatewayService.ListGateways
      # google.longrunning.Operations.GetOperation
      # google.longrunning.Operations.ListOperations
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="apigateway.googleapis.com" &&
                        (methodName.contains("GetApi") ||
                        methodName.contains("GetApiConfig") ||
                        methodName.contains("GetGateway") ||
                        methodName.contains("ListApiConfigs") ||
                        methodName.contains("ListApis") ||
                        methodName.contains("ListGateways") ||
                        methodName.contains("GetOperation") ||
                        methodName.contains("ListOperations"))

      # --------------------------------------------------------------------------------
      # API Keys audit logging
      # --------------------------------------------------------------------------------
      # ADMIN_READ
      # --------------------------------------------------------------------------------
      # google.api.apikeys.v2.ApiKeys.GetKeyString
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="apikeys.googleapis.com" &&
                        methodName.contains("GetKeyString")

      # --------------------------------------------------------------------------------
      # Apigee audit logging
      # --------------------------------------------------------------------------------
      # ADMIN_READ
      # --------------------------------------------------------------------------------
      # google.cloud.apigee.v1.AnalyticsCustomReport.GetCustomReport
      # google.cloud.apigee.v1.AnalyticsCustomReport.ListCustomReports
      # google.cloud.apigee.v1.AnalyticsDatastore.GetDatastore
      # google.cloud.apigee.v1.AnalyticsDatastore.ListDatastores
      # google.cloud.apigee.v1.AnalyticsSchema.GetSchema
      # google.cloud.apigee.v1.ApiCategories.GetApiCategory
      # google.cloud.apigee.v1.ApiCategories.ListApiCategories
      # google.cloud.apigee.v1.ApiDocs.GetApiDoc
      # google.cloud.apigee.v1.ApiDocs.GetApiDocDocumentation
      # google.cloud.apigee.v1.ApiDocs.ListApiDocs
      # google.cloud.apigee.v1.ApiDocs.ListPublishableProducts
      # google.cloud.apigee.v1.ApiProducts.GetApiProduct
      # google.cloud.apigee.v1.ApiProducts.GetApiProductAttribute
      # google.cloud.apigee.v1.ApiProducts.ListApiProductAttributes
      # google.cloud.apigee.v1.ApiProducts.ListApiProducts
      # google.cloud.apigee.v1.ApiProxyService.GetApiProxy
      # google.cloud.apigee.v1.ApiProxyService.GetApiProxyRevision
      # google.cloud.apigee.v1.ApiProxyService.ListApiProxies
      # google.cloud.apigee.v1.ApiProxyService.ListApiProxyRevisions
      # google.cloud.apigee.v1.AppGroupAppKeys.GetAppGroupAppKey
      # google.cloud.apigee.v1.AppGroupApps.GetAppGroupApp
      # google.cloud.apigee.v1.AppGroupApps.ListAppGroupApps
      # google.cloud.apigee.v1.AppGroups.GetAppGroup
      # google.cloud.apigee.v1.AppGroups.ListAppGroups
      # google.cloud.apigee.v1.Apps.GetApp
      # google.cloud.apigee.v1.Apps.ListApps
      # google.cloud.apigee.v1.ArchiveDeploymentService.ListArchiveDeployments
      # google.cloud.apigee.v1.AsyncQueryService.GetAsyncQuery
      # google.cloud.apigee.v1.AsyncQueryService.GetAsyncQueryResult
      # google.cloud.apigee.v1.AsyncQueryService.GetAsyncQueryResultView
      # google.cloud.apigee.v1.AsyncQueryService.GetHostAsyncQuery
      # google.cloud.apigee.v1.AsyncQueryService.GetHostAsyncQueryResult
      # google.cloud.apigee.v1.AsyncQueryService.ListAsyncQueries
      # google.cloud.apigee.v1.CacheService.ListCaches
      # google.cloud.apigee.v1.Consumer.GetConsumerAudience
      # google.cloud.apigee.v1.Consumer.GetConsumerTeam
      # google.cloud.apigee.v1.Consumer.GetConsumerUser
      # google.cloud.apigee.v1.Consumer.ListConsumerAudiences
      # google.cloud.apigee.v1.Consumer.ListConsumerTeams
      # google.cloud.apigee.v1.Consumer.ListConsumerUsers
      # google.cloud.apigee.v1.Customcss.GetCustomCss
      # google.cloud.apigee.v1.Customcss.GetEditorSchema
      # google.cloud.apigee.v1.DataCollectorService.GetDataCollector
      # google.cloud.apigee.v1.DataCollectorService.ListDataCollectors
      # google.cloud.apigee.v1.DataExport.GetExport
      # google.cloud.apigee.v1.DataExport.ListExports
      # google.cloud.apigee.v1.DeploymentService.GetApiDeployment
      # google.cloud.apigee.v1.DeploymentService.GetEnvironmentDeployment
      # google.cloud.apigee.v1.DeploymentService.GetFlowHook
      # google.cloud.apigee.v1.DeploymentService.GetIamPolicy
      # google.cloud.apigee.v1.DeploymentService.GetSharedFlowDeployment
      # google.cloud.apigee.v1.DeploymentService.ListApiDeployments
      # google.cloud.apigee.v1.DeploymentService.ListApiDeploymentsInEnvironment
      # google.cloud.apigee.v1.DeploymentService.ListApiRevisionDeployments
      # google.cloud.apigee.v1.DeploymentService.ListEnvironmentDeployments
      # google.cloud.apigee.v1.DeploymentService.ListFlowHooks
      # google.cloud.apigee.v1.DeploymentService.ListOrganizationDeployments
      # google.cloud.apigee.v1.DeploymentService.ListSharedFlowDeployments
      # google.cloud.apigee.v1.DeploymentService.ListSharedFlowDeploymentsInEnvironment
      # google.cloud.apigee.v1.DeploymentService.ListSharedFlowRevisionDeployments
      # google.cloud.apigee.v1.DeveloperAppKeys.GetDeveloperAppKey
      # google.cloud.apigee.v1.DeveloperApps.GetDeveloperApp
      # google.cloud.apigee.v1.DeveloperApps.GetDeveloperAppAttribute
      # google.cloud.apigee.v1.DeveloperApps.ListDeveloperAppAttributes
      # google.cloud.apigee.v1.DeveloperApps.ListDeveloperApps
      # google.cloud.apigee.v1.DeveloperSubscriptions.GetDeveloperSubscription
      # google.cloud.apigee.v1.DeveloperSubscriptions.ListDeveloperSubscriptions
      # google.cloud.apigee.v1.Developers.GetDeveloper
      # google.cloud.apigee.v1.Developers.GetDeveloperBalance
      # google.cloud.apigee.v1.Developers.GetDeveloperMonetizationConfig
      # google.cloud.apigee.v1.Developers.ListDeveloperAttributes
      # google.cloud.apigee.v1.Developers.ListDevelopers
      # google.cloud.apigee.v1.EndpointAttachmentService.GetEndpointAttachment
      # google.cloud.apigee.v1.EndpointAttachmentService.ListEndpointAttachments
      # google.cloud.apigee.v1.EnvironmentAddons.GetAddonsConfig
      # google.cloud.apigee.v1.EnvironmentGroupAttachmentService.GetEnvironmentGroupAttachment
      # google.cloud.apigee.v1.EnvironmentGroupAttachmentService.ListEnvironmentGroupAttachments
      # google.cloud.apigee.v1.EnvironmentGroupService.GetEnvironmentGroup
      # google.cloud.apigee.v1.EnvironmentGroupService.ListEnvironmentGroups
      # google.cloud.apigee.v1.EnvironmentService.GetApiSecurityRuntimeConfig
      # google.cloud.apigee.v1.EnvironmentService.GetDeployedConfig
      # google.cloud.apigee.v1.EnvironmentService.GetEnvironment
      # google.cloud.apigee.v1.EnvironmentService.GetIamPolicy
      # google.cloud.apigee.v1.EnvironmentService.ListEnvironments
      # google.cloud.apigee.v1.InstanceAttachmentService.GetInstanceAttachment
      # google.cloud.apigee.v1.InstanceAttachmentService.ListInstanceAttachments
      # google.cloud.apigee.v1.InstanceService.GetInstance
      # google.cloud.apigee.v1.InstanceService.ListInstances
      # google.cloud.apigee.v1.KeyValueMapService.GetKeyValueEntry
      # google.cloud.apigee.v1.KeyValueMapService.ListApiProxyKeyValueMaps
      # google.cloud.apigee.v1.KeyValueMapService.ListEnvironmentKeyValueMaps
      # google.cloud.apigee.v1.KeyValueMapService.ListKeyValueEntries
      # google.cloud.apigee.v1.KeyValueMapService.ListOrganizationKeyValueMaps
      # google.cloud.apigee.v1.KeystoreService.GetKeystore
      # google.cloud.apigee.v1.KeystoreService.ListKeystores
      # google.cloud.apigee.v1.MenuItems.ListMenuItems
      # google.cloud.apigee.v1.MenuTypes.ListMenuTypes
      # google.cloud.apigee.v1.MenuTypes.ListMenuTypesByPage
      # google.cloud.apigee.v1.NatAddressService.GetNatAddress
      # google.cloud.apigee.v1.NatAddressService.ListNatAddresses
      # google.cloud.apigee.v1.OrganizationService.GetControlPlaneAccess
      # google.cloud.apigee.v1.OrganizationService.GetOrganization
      # google.cloud.apigee.v1.OrganizationService.GetProjectMapping
      # google.cloud.apigee.v1.OrganizationService.GetSyncAuthorization
      # google.cloud.apigee.v1.Pages.GetPage
      # google.cloud.apigee.v1.Pages.ListPages
      # google.cloud.apigee.v1.RatePlans.GetRatePlan
      # google.cloud.apigee.v1.RatePlans.ListRatePlans
      # google.cloud.apigee.v1.ReferenceService.GetReference
      # google.cloud.apigee.v1.ReferenceService.ListReferences
      # google.cloud.apigee.v1.ResourceEntitlements.GetDefaultResourceEntitlements
      # google.cloud.apigee.v1.ResourceEntitlements.GetResourceEntitlement
      # google.cloud.apigee.v1.ResourceFileService.GetEnvironmentResource
      # google.cloud.apigee.v1.ResourceFileService.ListEnvironmentResources
      # google.cloud.apigee.v1.Resources.QueryApiDocs
      # google.cloud.apigee.v1.Resources.QueryPages
      # google.cloud.apigee.v1.RuntimeService.GetDeployedIngressConfig
      # google.cloud.apigee.v1.RuntimeService.GetEnvGroupDeployedIngressConfig
      # google.cloud.apigee.v1.RuntimeService.GetRuntimeConfig
      # google.cloud.apigee.v1.SecurityActionService.GetSecurityAction
      # google.cloud.apigee.v1.SecurityActionService.GetSecurityActionsConfig
      # google.cloud.apigee.v1.SecurityActionService.ListSecurityActions
      # google.cloud.apigee.v1.SecurityIncidentService.GetSecurityIncident
      # google.cloud.apigee.v1.SecurityIncidentService.ListSecurityIncidents
      # google.cloud.apigee.v1.SecurityProfileService.ComputeEnvironmentScores
      # google.cloud.apigee.v1.SecurityProfileService.GetSecurityProfile
      # google.cloud.apigee.v1.SecurityProfileService.ListSecurityProfileRevisions
      # google.cloud.apigee.v1.SecurityProfileService.ListSecurityProfiles
      # google.cloud.apigee.v1.SecurityReportService.CreateHostSecurityReport
      # google.cloud.apigee.v1.SecurityReportService.GetHostSecurityReportResult
      # google.cloud.apigee.v1.SecurityReportService.GetSecurityReport
      # google.cloud.apigee.v1.SecurityReportService.GetSecurityReportResult
      # google.cloud.apigee.v1.SecurityReportService.GetSecurityReportResultView
      # google.cloud.apigee.v1.SecurityReportService.ListHostSecurityReports
      # google.cloud.apigee.v1.SecurityReportService.ListSecurityReports
      # google.cloud.apigee.v1.SecurityRiskAssessmentV2Service.BatchComputeSecurityAssessmentResults
      # google.cloud.apigee.v1.SecurityRiskAssessmentV2Service.GetSecurityProfileV2
      # google.cloud.apigee.v1.SecurityRiskAssessmentV2Service.ListSecurityProfilesV2
      # google.cloud.apigee.v1.SecuritySettingsService.GetSecuritySettings
      # google.cloud.apigee.v1.SecurityStatsService.QueryTabularStats
      # google.cloud.apigee.v1.SecurityStatsService.QueryTimeSeriesStats
      # google.cloud.apigee.v1.SharedFlowService.GetSharedFlow
      # google.cloud.apigee.v1.SharedFlowService.GetSharedFlowRevision
      # google.cloud.apigee.v1.SharedFlowService.ListSharedFlowRevisions
      # google.cloud.apigee.v1.SharedFlowService.ListSharedFlows
      # google.cloud.apigee.v1.SiteDomain.GetCustomDomainConfig
      # google.cloud.apigee.v1.SiteEmail.GetEmailTemplate
      # google.cloud.apigee.v1.SiteFile.ListFiles
      # google.cloud.apigee.v1.SiteOperation.GetContentSecurityPolicy
      # google.cloud.apigee.v1.SiteOperation.GetDefaultAnonAllowed
      # google.cloud.apigee.v1.SiteOperation.GetDraftToken
      # google.cloud.apigee.v1.SiteOperation.GetOrgType
      # google.cloud.apigee.v1.Sites.GetAllInOrgOrSingleWithDomain
      # google.cloud.apigee.v1.Sites.GetSite
      # google.cloud.apigee.v1.Sites.GetSmtp
      # google.cloud.apigee.v1.System.GetAnnouncement
      # google.cloud.apigee.v1.System.GetConfig
      # google.cloud.apigee.v1.System.GetSystemState
      # google.cloud.apigee.v1.TargetServerService.GetTargetServer
      # google.cloud.apigee.v1.TargetServerService.ListTargetServers
      # google.cloud.apigee.v1.TraceConfigOverrideService.ListTraceConfigOverrides
      # google.cloud.apigee.v1.TraceConfigService.GetTraceConfig
      # google.cloud.apigee.v1.Zones.GetAudiencesEnabled
      # google.cloud.apigee.v1.Zones.GetZone
      # google.cloud.apigee.v1.Zones.ListIdentityProviders
      # google.longrunning.Operations.GetOperation
      # google.longrunning.Operations.ListOperations
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="apigee.googleapis.com" &&
                        (methodName.contains("GetCustomReport") ||
                        methodName.contains("ListCustomReports") ||
                        methodName.contains("GetDatastore") ||
                        methodName.contains("ListDatastores") ||
                        methodName.contains("GetSchema") ||
                        methodName.contains("GetApiCategory") ||
                        methodName.contains("ListApiCategories") ||
                        methodName.contains("GetApiDoc") ||
                        methodName.contains("GetApiDocDocumentation") ||
                        methodName.contains("ListApiDocs") ||
                        methodName.contains("ListPublishableProducts") ||
                        methodName.contains("GetApiProduct") ||
                        methodName.contains("GetApiProductAttribute") ||
                        methodName.contains("ListApiProductAttributes") ||
                        methodName.contains("ListApiProducts") ||
                        methodName.contains("GetApiProxy") ||
                        methodName.contains("GetApiProxyRevision") ||
                        methodName.contains("ListApiProxies") ||
                        methodName.contains("ListApiProxyRevisions") ||
                        methodName.contains("GetAppGroupAppKey") ||
                        methodName.contains("GetAppGroupApp") ||
                        methodName.contains("ListAppGroupApps") ||
                        methodName.contains("GetAppGroup") ||
                        methodName.contains("ListAppGroups") ||
                        methodName.contains("GetApp") ||
                        methodName.contains("ListApps") ||
                        methodName.contains("ListArchiveDeployments") ||
                        methodName.contains("GetAsyncQuery") ||
                        methodName.contains("GetAsyncQueryResult") ||
                        methodName.contains("GetAsyncQueryResultView") ||
                        methodName.contains("GetHostAsyncQuery") ||
                        methodName.contains("GetHostAsyncQueryResult") ||
                        methodName.contains("ListAsyncQueries") ||
                        methodName.contains("ListCaches") ||
                        methodName.contains("GetConsumerAudience") ||
                        methodName.contains("GetConsumerTeam") ||
                        methodName.contains("GetConsumerUser") ||
                        methodName.contains("ListConsumerAudiences") ||
                        methodName.contains("ListConsumerTeams") ||
                        methodName.contains("ListConsumerUsers") ||
                        methodName.contains("GetCustomCss") ||
                        methodName.contains("GetEditorSchema") ||
                        methodName.contains("GetDataCollector") ||
                        methodName.contains("ListDataCollectors") ||
                        methodName.contains("GetExport") ||
                        methodName.contains("ListExports") ||
                        methodName.contains("GetApiDeployment") ||
                        methodName.contains("GetEnvironmentDeployment") ||
                        methodName.contains("GetFlowHook") ||
                        methodName.contains("GetIamPolicy") ||
                        methodName.contains("GetSharedFlowDeployment") ||
                        methodName.contains("ListApiDeployments") ||
                        methodName.contains("ListApiDeploymentsInEnvironment") ||
                        methodName.contains("ListApiRevisionDeployments") ||
                        methodName.contains("ListEnvironmentDeployments") ||
                        methodName.contains("ListFlowHooks") ||
                        methodName.contains("ListOrganizationDeployments") ||
                        methodName.contains("ListSharedFlowDeployments") ||
                        methodName.contains("ListSharedFlowDeploymentsInEnvironment") ||
                        methodName.contains("ListSharedFlowRevisionDeployments") ||
                        methodName.contains("GetDeveloperAppKey") ||
                        methodName.contains("GetDeveloperApp") ||
                        methodName.contains("GetDeveloperAppAttribute") ||
                        methodName.contains("ListDeveloperAppAttributes") ||
                        methodName.contains("ListDeveloperApps") ||
                        methodName.contains("GetDeveloperSubscription") ||
                        methodName.contains("ListDeveloperSubscriptions") ||
                        methodName.contains("GetDeveloper") ||
                        methodName.contains("GetDeveloperBalance") ||
                        methodName.contains("GetDeveloperMonetizationConfig") ||
                        methodName.contains("ListDeveloperAttributes") ||
                        methodName.contains("ListDevelopers") ||
                        methodName.contains("GetEndpointAttachment") ||
                        methodName.contains("ListEndpointAttachments") ||
                        methodName.contains("GetAddonsConfig") ||
                        methodName.contains("GetEnvironmentGroupAttachment") ||
                        methodName.contains("ListEnvironmentGroupAttachments") ||
                        methodName.contains("GetEnvironmentGroup") ||
                        methodName.contains("ListEnvironmentGroups") ||
                        methodName.contains("GetApiSecurityRuntimeConfig") ||
                        methodName.contains("GetDeployedConfig") ||
                        methodName.contains("GetEnvironment") ||
                        methodName.contains("GetIamPolicy") ||
                        methodName.contains("ListEnvironments") ||
                        methodName.contains("GetInstanceAttachment") ||
                        methodName.contains("ListInstanceAttachments") ||
                        methodName.contains("GetInstance") ||
                        methodName.contains("ListInstances") ||
                        methodName.contains("GetKeyValueEntry") ||
                        methodName.contains("ListApiProxyKeyValueMaps") ||
                        methodName.contains("ListEnvironmentKeyValueMaps") ||
                        methodName.contains("ListKeyValueEntries") ||
                        methodName.contains("ListOrganizationKeyValueMaps") ||
                        methodName.contains("GetKeystore") ||
                        methodName.contains("ListKeystores") ||
                        methodName.contains("ListMenuItems") ||
                        methodName.contains("ListMenuTypes") ||
                        methodName.contains("ListMenuTypesByPage") ||
                        methodName.contains("GetNatAddress") ||
                        methodName.contains("ListNatAddresses") ||
                        methodName.contains("GetControlPlaneAccess") ||
                        methodName.contains("GetOrganization") ||
                        methodName.contains("GetProjectMapping") ||
                        methodName.contains("GetSyncAuthorization") ||
                        methodName.contains("GetPage") ||
                        methodName.contains("ListPages") ||
                        methodName.contains("GetRatePlan") ||
                        methodName.contains("ListRatePlans") ||
                        methodName.contains("GetReference") ||
                        methodName.contains("ListReferences") ||
                        methodName.contains("GetDefaultResourceEntitlements") ||
                        methodName.contains("GetResourceEntitlement") ||
                        methodName.contains("GetEnvironmentResource") ||
                        methodName.contains("ListEnvironmentResources") ||
                        methodName.contains("QueryApiDocs") ||
                        methodName.contains("QueryPages") ||
                        methodName.contains("GetDeployedIngressConfig") ||
                        methodName.contains("GetEnvGroupDeployedIngressConfig") ||
                        methodName.contains("GetRuntimeConfig") ||
                        methodName.contains("GetSecurityAction") ||
                        methodName.contains("GetSecurityActionsConfig") ||
                        methodName.contains("ListSecurityActions") ||
                        methodName.contains("GetSecurityIncident") ||
                        methodName.contains("ListSecurityIncidents") ||
                        methodName.contains("ComputeEnvironmentScores") ||
                        methodName.contains("GetSecurityProfile") ||
                        methodName.contains("ListSecurityProfileRevisions") ||
                        methodName.contains("ListSecurityProfiles") ||
                        methodName.contains("CreateHostSecurityReport") ||
                        methodName.contains("GetHostSecurityReportResult") ||
                        methodName.contains("GetSecurityReport") ||
                        methodName.contains("GetSecurityReportResult") ||
                        methodName.contains("GetSecurityReportResultView") ||
                        methodName.contains("ListHostSecurityReports") ||
                        methodName.contains("ListSecurityReports") ||
                        methodName.contains("BatchComputeSecurityAssessmentResults") ||
                        methodName.contains("GetSecurityProfileV2") ||
                        methodName.contains("ListSecurityProfilesV2") ||
                        methodName.contains("GetSecuritySettings") ||
                        methodName.contains("QueryTabularStats") ||
                        methodName.contains("QueryTimeSeriesStats") ||
                        methodName.contains("GetSharedFlow") ||
                        methodName.contains("GetSharedFlowRevision") ||
                        methodName.contains("ListSharedFlowRevisions") ||
                        methodName.contains("ListSharedFlows") ||
                        methodName.contains("GetCustomDomainConfig") ||
                        methodName.contains("GetEmailTemplate") ||
                        methodName.contains("ListFiles") ||
                        methodName.contains("GetContentSecurityPolicy") ||
                        methodName.contains("GetDefaultAnonAllowed") ||
                        methodName.contains("GetDraftToken") ||
                        methodName.contains("GetOrgType") ||
                        methodName.contains("GetAllInOrgOrSingleWithDomain") ||
                        methodName.contains("GetSite") ||
                        methodName.contains("GetSmtp") ||
                        methodName.contains("GetAnnouncement") ||
                        methodName.contains("GetConfig") ||
                        methodName.contains("GetSystemState") ||
                        methodName.contains("GetTargetServer") ||
                        methodName.contains("ListTargetServers") ||
                        methodName.contains("ListTraceConfigOverrides") ||
                        methodName.contains("GetTraceConfig") ||
                        methodName.contains("GetAudiencesEnabled") ||
                        methodName.contains("GetZone") ||
                        methodName.contains("ListIdentityProviders") ||
                        methodName.contains("GetOperation") ||
                        methodName.contains("ListOperations"))

      # --------------------------------------------------------------------------------
      # DATA_READ
      # --------------------------------------------------------------------------------
      # google.cloud.apigee.v1.AnalyticsInteractiveQuery.GetHostStats
      # google.cloud.apigee.v1.AnalyticsInteractiveQuery.GetOptimizedHostStats
      # google.cloud.apigee.v1.AnalyticsInteractiveQuery.GetOptimizedStats
      # google.cloud.apigee.v1.AnalyticsInteractiveQuery.GetStats
      # google.cloud.apigee.v1.CollectionService.GetDataLocation
      # google.cloud.apigee.v1.DataMaskService.GetEnvironmentDebugMask
      # google.cloud.apigee.v1.DebugSessionService.GetDebugSession
      # google.cloud.apigee.v1.DebugSessionService.GetDebugSessionTransaction
      # google.cloud.apigee.v1.DebugSessionService.ListDebugSessionTransactions
      # google.cloud.apigee.v1.DebugSessionService.ListDebugSessions
      # google.cloud.apigee.v1.KeystoreService.GenerateCsr
      # google.cloud.apigee.v1.KeystoreService.GetAlias
      # google.cloud.apigee.v1.KeystoreService.ListAliases
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="apigee.googleapis.com" &&
                        (methodName.contains("GetHostStats") ||
                        methodName.contains("GetOptimizedHostStats") ||
                        methodName.contains("GetOptimizedStats") ||
                        methodName.contains("GetStats") ||
                        methodName.contains("GetDataLocation") ||
                        methodName.contains("GetEnvironmentDebugMask") ||
                        methodName.contains("GetDebugSession") ||
                        methodName.contains("GetDebugSessionTransaction") ||
                        methodName.contains("ListDebugSessionTransactions") ||
                        methodName.contains("ListDebugSessions") ||
                        methodName.contains("GenerateCsr") ||
                        methodName.contains("GetAlias") ||
                        methodName.contains("ListAliases"))

      # --------------------------------------------------------------------------------
      # Apigee API Management audit logging
      # --------------------------------------------------------------------------------
      # ADMIN_READ
      # --------------------------------------------------------------------------------
      # google.cloud.apim.v1alpha.ApiDiscoveryObservation.GetObservationSource
      # google.cloud.apim.v1alpha.ApiDiscoveryObservation.ListObservationJobs
      # google.cloud.apim.v1alpha.ApiDiscoveryObservation.ListObservationSources
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="apim.googleapis.com" &&
                        (methodName.contains("GetObservationSource") ||
                        methodName.contains("ListObservationJobs") ||
                        methodName.contains("ListObservationSources"))

      # --------------------------------------------------------------------------------
      # Apigee Connect audit logging
      # --------------------------------------------------------------------------------
      # ADMIN_READ
      # --------------------------------------------------------------------------------
      # google.cloud.apigeeconnect.v1.ConnectionService.ListConnections
      - drop:
          where:
            variables:
              - get: log.protoPayload.serviceName
                as: serviceName
                ofType: string
              - get: log.protoPayload.methodName
                as: methodName
                ofType: string
            expression: serviceName_ok==true && methodName_ok==true &&
                        serviceName=="apigeeconnect.googleapis.com" &&
                        methodName.contains("ListConnections")

      # --------------------------------------------------------------------------------
      # Apigee audit logging
      # --------------------------------------------------------------------------------
      # ADMIN_READ
      # --------------------------------------------------------------------------------
      # google.cloud.apigee.v1.AnalyticsCustomReport.GetCustomReport
      # google.cloud.apigee.v1.AnalyticsCustomReport.ListCustomReports
      # google.cloud.apigee.v1.AnalyticsDatastore.GetDatastore
      # google.cloud.apigee.v1.AnalyticsDatastore.ListDatastores
      # google.cloud.apigee.v1.AnalyticsSchema.GetSchema
      # google.cloud.apigee.v1.ApiCategories.GetApiCategory
      # google.cloud.apigee.v1.ApiCategories.ListApiCategories
      # google.cloud.apigee.v1.ApiDocs.GetApiDoc
      # google.cloud.apigee.v1.ApiDocs.GetApiDocDocumentation
      # google.cloud.apigee.v1.ApiDocs.ListApiDocs
      # google.cloud.apigee.v1.ApiDocs.ListPublishableProducts
      # google.cloud.apigee.v1.ApiProducts.GetApiProduct
      # google.cloud.apigee.v1.ApiProducts.GetApiProductAttribute
      # google.cloud.apigee.v1.ApiProducts.ListApiProductAttributes
      # google.cloud.apigee.v1.ApiProducts.ListApiProducts
      # google.cloud.apigee.v1.ApiProxyService.GetApiProxy
      # google.cloud.apigee.v1.ApiProxyService.GetApiProxyRevision
      # google.cloud.apigee.v1.ApiProxyService.ListApiProxies
      # google.cloud.apigee.v1.ApiProxyService.ListApiProxyRevisions
      # google.cloud.apigee.v1.AppGroupAppKeys.GetAppGroupAppKey
      # google.cloud.apigee.v1.AppGroupApps.GetAppGroupApp
      # google.cloud.apigee.v1.AppGroupApps.ListAppGroupApps
      # google.cloud.apigee.v1.AppGroups.GetAppGroup
      # google.cloud.apigee.v1.AppGroups.ListAppGroups
      # google.cloud.apigee.v1.Apps.GetApp
      # google.cloud.apigee.v1.Apps.ListApps
      # google.cloud.apigee.v1.ArchiveDeploymentService.ListArchiveDeployments
      # google.cloud.apigee.v1.AsyncQueryService.GetAsyncQuery
      # google.cloud.apigee.v1.AsyncQueryService.GetAsyncQueryResult
      # google.cloud.apigee.v1.AsyncQueryService.GetAsyncQueryResultView
      # google.cloud.apigee.v1.AsyncQueryService.GetHostAsyncQuery
      # google.cloud.apigee.v1.AsyncQueryService.GetHostAsyncQueryResult
      # google.cloud.apigee.v1.AsyncQueryService.ListAsyncQueries
      # google.cloud.apigee.v1.CacheService.ListCaches
      # google.cloud.apigee.v1.Consumer.GetConsumerAudience
      # google.cloud.apigee.v1.Consumer.GetConsumerTeam
      # google.cloud.apigee.v1.Consumer.GetConsumerUser
      # google.cloud.apigee.v1.Consumer.ListConsumerAudiences
      # google.cloud.apigee.v1.Consumer.ListConsumerTeams
      # google.cloud.apigee.v1.Consumer.ListConsumerUsers
      # google.cloud.apigee.v1.Customcss.GetCustomCss
      # google.cloud.apigee.v1.Customcss.GetEditorSchema
      # google.cloud.apigee.v1.DataCollectorService.GetDataCollector
      # google.cloud.apigee.v1.DataCollectorService.ListDataCollectors
      # google.cloud.apigee.v1.DataExport.GetExport
      # google.cloud.apigee.v1.DataExport.ListExports
      # google.cloud.apigee.v1.DeploymentService.GetApiDeployment
      # google.cloud.apigee.v1.DeploymentService.GetEnvironmentDeployment
      # google.cloud.apigee.v1.DeploymentService.GetFlowHook
      # google.cloud.apigee.v1.DeploymentService.GetIamPolicy
      # google.cloud.apigee.v1.DeploymentService.GetSharedFlowDeployment
      # google.cloud.apigee.v1.DeploymentService.ListApiDeployments
      # google.cloud.apigee.v1.DeploymentService.ListApiDeploymentsInEnvironment
      # google.cloud.apigee.v1.DeploymentService.ListApiRevisionDeployments
      # google.cloud.apigee.v1.DeploymentService.ListEnvironmentDeployments
      # google.cloud.apigee.v1.DeploymentService.ListFlowHooks
      # google.cloud.apigee.v1.DeploymentService.ListOrganizationDeployments
      # google.cloud.apigee.v1.DeploymentService.ListSharedFlowDeployments
      # google.cloud.apigee.v1.DeploymentService.ListSharedFlowDeploymentsInEnvironment
      # google.cloud.apigee.v1.DeploymentService.ListSharedFlowRevisionDeployments
      # google.cloud.apigee.v1.DeveloperAppKeys.GetDeveloperAppKey
      # google.cloud.apigee.v1.DeveloperApps.GetDeveloperApp
      # google.cloud.apigee.v1.DeveloperApps.GetDeveloperAppAttribute
      # google.cloud.apigee.v1.DeveloperApps.ListDeveloperAppAttributes
      # google.cloud.apigee.v1.DeveloperApps.ListDeveloperApps
      # google.cloud.apigee.v1.DeveloperSubscriptions.GetDeveloperSubscription
      # google.cloud.apigee.v1.DeveloperSubscriptions.ListDeveloperSubscriptions
      # google.cloud.apigee.v1.Developers.GetDeveloper
      # google.cloud.apigee.v1.Developers.GetDeveloperBalance
      # google.cloud.apigee.v1.Developers.GetDeveloperMonetizationConfig
      # google.cloud.apigee.v1.Developers.ListDeveloperAttributes
      # google.cloud.apigee.v1.Developers.ListDevelopers
      # google.cloud.apigee.v1.EndpointAttachmentService.GetEndpointAttachment
      # google.cloud.apigee.v1.EndpointAttachmentService.ListEndpointAttachments
      # google.cloud.apigee.v1.EnvironmentAddons.GetAddonsConfig
      # google.cloud.apigee.v1.EnvironmentGroupAttachmentService.GetEnvironmentGroupAttachment
      # google.cloud.apigee.v1.EnvironmentGroupAttachmentService.ListEnvironmentGroupAttachments
      # google.cloud.apigee.v1.EnvironmentGroupService.GetEnvironmentGroup
      # google.cloud.apigee.v1.EnvironmentGroupService.ListEnvironmentGroups
      # google.cloud.apigee.v1.EnvironmentService.GetApiSecurityRuntimeConfig
      # google.cloud.apigee.v1.EnvironmentService.GetDeployedConfig
      # google.cloud.apigee.v1.EnvironmentService.GetEnvironment
      # google.cloud.apigee.v1.EnvironmentService.GetIamPolicy
      # google.cloud.apigee.v1.EnvironmentService.ListEnvironments
      # google.cloud.apigee.v1.InstanceAttachmentService.GetInstanceAttachment
      # google.cloud.apigee.v1.InstanceAttachmentService.ListInstanceAttachments
      # google.cloud.apigee.v1.InstanceService.GetInstance
      # google.cloud.apigee.v1.InstanceService.ListInstances
      # google.cloud.apigee.v1.KeyValueMapService.GetKeyValueEntry
      # google.cloud.apigee.v1.KeyValueMapService.ListApiProxyKeyValueMaps
      # google.cloud.apigee.v1.KeyValueMapService.ListEnvironmentKeyValueMaps
      # google.cloud.apigee.v1.KeyValueMapService.ListKeyValueEntries
      # google.cloud.apigee.v1.KeyValueMapService.ListOrganizationKeyValueMaps
      # google.cloud.apigee.v1.KeystoreService.GetKeystore
      # google.cloud.apigee.v1.KeystoreService.ListKeystores
      # google.cloud.apigee.v1.MenuItems.ListMenuItems
      # google.cloud.apigee.v1.MenuTypes.ListMenuTypes
      # google.cloud.apigee.v1.MenuTypes.ListMenuTypesByPage
      # google.cloud.apigee.v1.NatAddressService.GetNatAddress
      # google.cloud.apigee.v1.NatAddressService.ListNatAddresses
      # google.cloud.apigee.v1.OrganizationService.GetControlPlaneAccess
      # google.cloud.apigee.v1.OrganizationService.GetOrganization
      # google.cloud.apigee.v1.OrganizationService.GetProjectMapping
      # google.cloud.apigee.v1.OrganizationService.GetSyncAuthorization
      # google.cloud.apigee.v1.Pages.GetPage
      # google.cloud.apigee.v1.Pages.ListPages
      # google.cloud.apigee.v1.RatePlans.GetRatePlan
      # google.cloud.apigee.v1.RatePlans.ListRatePlans
      # google.cloud.apigee.v1.ReferenceService.GetReference
      # google.cloud.apigee.v1.ReferenceService.ListReferences
      # google.cloud.apigee.v1.ResourceEntitlements.GetDefaultResourceEntitlements
      # google.cloud.apigee.v1.ResourceEntitlements.GetResourceEntitlement
      # google.cloud.apigee.v1.ResourceFileService.GetEnvironmentResource
      # google.cloud.apigee.v1.ResourceFileService.ListEnvironmentResources
      # google.cloud.apigee.v1.Resources.QueryApiDocs
      # google.cloud.apigee.v1.Resources.QueryPages
      # google.cloud.apigee.v1.RuntimeService.GetDeployedIngressConfig
      # google.cloud.apigee.v1.RuntimeService.GetEnvGroupDeployedIngressConfig
      # google.cloud.apigee.v1.RuntimeService.GetRuntimeConfig
      # google.cloud.apigee.v1.SecurityActionService.GetSecurityAction
      # google.cloud.apigee.v1.SecurityActionService.GetSecurityActionsConfig
      # google.cloud.apigee.v1.SecurityActionService.ListSecurityActions
      # google.cloud.apigee.v1.SecurityIncidentService.GetSecurityIncident
      # google.cloud.apigee.v1.SecurityIncidentService.ListSecurityIncidents
      # google.cloud.apigee.v1.SecurityProfileService.ComputeEnvironmentScores
      # google.cloud.apigee.v1.SecurityProfileService.GetSecurityProfile
      # google.cloud.apigee.v1.SecurityProfileService.ListSecurityProfileRevisions
      # google.cloud.apigee.v1.SecurityProfileService.ListSecurityProfiles
      # google.cloud.apigee.v1.SecurityReportService.CreateHostSecurityReport
      # google.cloud.apigee.v1.SecurityReportService.GetHostSecurityReportResult
      # google.cloud.apigee.v1.SecurityReportService.GetSecurityReport
      # google.cloud.apigee.v1.SecurityReportService.GetSecurityReportResult
      # google.cloud.apigee.v1.SecurityReportService.GetSecurityReportResultView
      # google.cloud.apigee.v1.SecurityReportService.ListHostSecurityReports
      # google.cloud.apigee.v1.SecurityReportService.ListSecurityReports
      # google.cloud.apigee.v1.SecurityRiskAssessmentV2Service.BatchComputeSecurityAssessmentResults
      # google.cloud.apigee.v1.SecurityRiskAssessmentV2Service.GetSecurityProfileV2
      # google.cloud.apigee.v1.SecurityRiskAssessmentV2Service.ListSecurityProfilesV2
      # google.cloud.apigee.v1.SecuritySettingsService.GetSecuritySettings
      # google.cloud.apigee.v1.SecurityStatsService.QueryTabularStats
      # google.cloud.apigee.v1.SecurityStatsService.QueryTimeSeriesStats
      # google.cloud.apigee.v1.SharedFlowService.GetSharedFlow
      # google.cloud.apigee.v1.SharedFlowService.GetSharedFlowRevision
      # google.cloud.apigee.v1.SharedFlowService.ListSharedFlowRevisions
      # google.cloud.apigee.v1.SharedFlowService.ListSharedFlows
      # google.cloud.apigee.v1.SiteDomain.GetCustomDomainConfig
      # google.cloud.apigee.v1.SiteEmail.GetEmailTemplate
      # google.cloud.apigee.v1.SiteFile.ListFiles
      # google.cloud.apigee.v1.SiteOperation.GetContentSecurityPolicy
      # g'
	WHERE id=1301;
            ]]>
        </sql>
    </changeSet>
</databaseChangeLog>